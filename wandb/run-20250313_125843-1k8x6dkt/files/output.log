=== Iniciando experimento con pooling_type=mean ===
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/5
Train - Loss: 0.6692, Acc: 0.6082, AUC: 0.6276, F1: 0.4550
Val   - Loss: 0.6142, Acc: 0.6733, AUC: 0.7254, F1: 0.4235
Final model saved to ./models/rsna_mean/model_mean.pth
Epoch 2/5
Train - Loss: 0.6177, Acc: 0.6576, AUC: 0.7008, F1: 0.5374
Val   - Loss: 0.5830, Acc: 0.7067, AUC: 0.7760, F1: 0.5217
Final model saved to ./models/rsna_mean/model_mean.pth
Epoch 3/5
Train - Loss: 0.5710, Acc: 0.7024, AUC: 0.7551, F1: 0.6028
Val   - Loss: 0.6052, Acc: 0.6533, AUC: 0.7956, F1: 0.6709
Final model saved to ./models/rsna_mean/model_mean.pth
Epoch 4/5
Train - Loss: 0.5643, Acc: 0.7082, AUC: 0.7704, F1: 0.6173
Val   - Loss: 0.5305, Acc: 0.7133, AUC: 0.8120, F1: 0.5905
Final model saved to ./models/rsna_mean/model_mean.pth
Epoch 5/5
Train - Loss: 0.5449, Acc: 0.7224, AUC: 0.7873, F1: 0.6467
Val   - Loss: 0.5216, Acc: 0.7333, AUC: 0.8191, F1: 0.6154
Final model saved to ./models/rsna_mean/model_mean.pth
./models/rsna_mean/model_mean.pth
Model loaded successfully from ./models/rsna_mean/model_mean.pth

--- Evaluation Results ---
Optimal Threshold: 0.4583
Accuracy: 0.7933, AUC: 0.8540
Precision: 0.8060, Recall: 0.7500, F1-Score: 0.7770
Confusion Matrix:
[[65 13]
 [18 54]]
