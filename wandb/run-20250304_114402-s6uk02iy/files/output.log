rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/1, Train Loss: 0.6382, Train Accuracy: 0.6388, Val Loss: 0.6458, Val Accuracy: 0.6000
Final model saved to ./models/rsna/model.pth
Model loaded successfully from ./models/rsna/model.pth

--- Evaluation Results ---
Traceback (most recent call last):
  File "/home/javitrucas/TFG/scripts/medical_scripts/medical_main.py", line 75, in <module>
    evaluator.evaluate()
  File "/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py", line 83, in evaluate
    self._log_metrics(metrics)
  File "/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py", line 91, in _log_metrics
    print(f"Optimal Threshold: {metrics['optimal_threshold']:.4f}")
                                ~~~~~~~^^^^^^^^^^^^^^^^^^^^^
KeyError: 'optimal_threshold'
