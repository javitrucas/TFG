panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|██████████| 8822/8822 [01:43<00:00, 85.12it/s]
[WSIDataset] Building data dict: 100%|██████████| 1794/1794 [00:38<00:00, 46.71it/s]
[WSIDataset] Skipped 5 bags
[WSIDataset] Found 8817 already processed bags
panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict:  99%|█████████▉| 1785/1794 [00:38<00:00, 113.00it/s]
[WSIDataset] Skipped 0 bags
[WSIDataset] Found 1794 already processed bags
Epoch 1/15
Train - Loss: 0.2443, Acc: 0.9142, AUC: 0.9652, F1: 0.9412
Val   - Loss: 0.4270, Acc: 0.8413, AUC: 0.9762, F1: 0.9008
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 2/15
Train - Loss: 0.2219, Acc: 0.9317, AUC: 0.9760, F1: 0.9531
Val   - Loss: 0.2173, Acc: 0.9342, AUC: 0.9810, F1: 0.9545
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 3/15
Train - Loss: 0.2407, Acc: 0.9328, AUC: 0.9771, F1: 0.9539
Val   - Loss: 0.3567, Acc: 0.9337, AUC: 0.9809, F1: 0.9525
Epoch 4/15
Train - Loss: 0.2542, Acc: 0.9312, AUC: 0.9747, F1: 0.9528
Val   - Loss: 0.4200, Acc: 0.9212, AUC: 0.9716, F1: 0.9467
Epoch 5/15
Train - Loss: 0.2650, Acc: 0.9310, AUC: 0.9777, F1: 0.9525
Val   - Loss: 0.4084, Acc: 0.9127, AUC: 0.9632, F1: 0.9407
Epoch 6/15
Train - Loss: 0.2629, Acc: 0.9356, AUC: 0.9784, F1: 0.9558
Val   - Loss: 0.4720, Acc: 0.8906, AUC: 0.9836, F1: 0.9296
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 7/15
Train - Loss: 0.2661, Acc: 0.9380, AUC: 0.9777, F1: 0.9575
Val   - Loss: 0.5561, Acc: 0.9206, AUC: 0.9797, F1: 0.9427
Epoch 8/15
Train - Loss: 0.2613, Acc: 0.9437, AUC: 0.9784, F1: 0.9613
Val   - Loss: 0.2882, Acc: 0.9359, AUC: 0.9785, F1: 0.9550
Epoch 9/15
Train - Loss: 0.2989, Acc: 0.9385, AUC: 0.9766, F1: 0.9578
Val   - Loss: 0.3212, Acc: 0.9354, AUC: 0.9783, F1: 0.9552
Epoch 10/15
Train - Loss: 0.2835, Acc: 0.9399, AUC: 0.9779, F1: 0.9588
Val   - Loss: 0.4931, Acc: 0.9280, AUC: 0.9798, F1: 0.9487
Epoch 11/15
Train - Loss: 0.3227, Acc: 0.9399, AUC: 0.9776, F1: 0.9587
Val   - Loss: 0.4203, Acc: 0.9365, AUC: 0.9823, F1: 0.9551
Early stopping triggered.
Model loaded successfully from ./models/panda/attention/model.pth
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.6847
Accuracy: 0.9476, AUC: 0.9872
Precision: 0.9886, Recall: 0.9383, F1-Score: 0.9628
Confusion Matrix:
[[ 483   14]
 [  80 1217]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
