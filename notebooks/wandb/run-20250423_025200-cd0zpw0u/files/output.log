panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|██████████| 8822/8822 [01:58<00:00, 74.27it/s]
[WSIDataset] Building data dict: 100%|██████████| 1794/1794 [00:19<00:00, 90.38it/s] 
[WSIDataset] Skipped 5 bags
[WSIDataset] Found 8817 already processed bags
panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|█████████▉| 1792/1794 [00:19<00:00, 85.60it/s] 
[WSIDataset] Skipped 0 bags
[WSIDataset] Found 1794 already processed bags
Epoch 1/15
Train - Loss: 0.1668, Acc: 0.9288, AUC: 0.9780, F1: 0.9510
Val   - Loss: 0.1304, Acc: 0.9507, AUC: 0.9865, F1: 0.9662
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 2/15
Train - Loss: 0.1268, Acc: 0.9485, AUC: 0.9872, F1: 0.9645
Val   - Loss: 0.1280, Acc: 0.9558, AUC: 0.9864, F1: 0.9697
Epoch 3/15
Train - Loss: 0.1114, Acc: 0.9548, AUC: 0.9900, F1: 0.9688
Val   - Loss: 0.1585, Acc: 0.9410, AUC: 0.9857, F1: 0.9604
Epoch 4/15
Train - Loss: 0.1057, Acc: 0.9590, AUC: 0.9909, F1: 0.9717
Val   - Loss: 0.1200, Acc: 0.9518, AUC: 0.9881, F1: 0.9667
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 5/15
Train - Loss: 0.1001, Acc: 0.9603, AUC: 0.9919, F1: 0.9726
Val   - Loss: 0.1338, Acc: 0.9529, AUC: 0.9863, F1: 0.9677
Epoch 6/15
Train - Loss: 0.0924, Acc: 0.9633, AUC: 0.9929, F1: 0.9747
Val   - Loss: 0.1282, Acc: 0.9490, AUC: 0.9875, F1: 0.9644
Epoch 7/15
Train - Loss: 0.0896, Acc: 0.9654, AUC: 0.9935, F1: 0.9761
Val   - Loss: 0.1318, Acc: 0.9507, AUC: 0.9872, F1: 0.9660
Epoch 8/15
Train - Loss: 0.0851, Acc: 0.9660, AUC: 0.9938, F1: 0.9765
Val   - Loss: 0.1267, Acc: 0.9490, AUC: 0.9874, F1: 0.9648
Epoch 9/15
Train - Loss: 0.0839, Acc: 0.9680, AUC: 0.9942, F1: 0.9779
Val   - Loss: 0.1356, Acc: 0.9501, AUC: 0.9866, F1: 0.9658
Early stopping triggered.
Model loaded successfully from ./models/panda/attention/model.pth
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.9152
Accuracy: 0.9431, AUC: 0.9885
Precision: 0.9886, Recall: 0.9322, F1-Score: 0.9595
Confusion Matrix:
[[ 483   14]
 [  88 1209]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
