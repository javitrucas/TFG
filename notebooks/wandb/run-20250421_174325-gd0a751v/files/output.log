rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.7503, Acc: 0.5887, AUC: 0.5837, F1: 0.4471
Val   - Loss: 0.7204, Acc: 0.6000, AUC: 0.7800, F1: 0.0698
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 2/50
Train - Loss: 0.6561, Acc: 0.6600, AUC: 0.7042, F1: 0.5467
Val   - Loss: 0.5694, Acc: 0.7200, AUC: 0.7686, F1: 0.6456
Epoch 3/50
Train - Loss: 0.5674, Acc: 0.7113, AUC: 0.7724, F1: 0.6292
Val   - Loss: 0.7473, Acc: 0.6100, AUC: 0.7819, F1: 0.6638
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 4/50
Train - Loss: 0.5691, Acc: 0.7150, AUC: 0.7739, F1: 0.6311
Val   - Loss: 0.5441, Acc: 0.7200, AUC: 0.7988, F1: 0.6410
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 5/50
Train - Loss: 0.5552, Acc: 0.7325, AUC: 0.7845, F1: 0.6480
Val   - Loss: 0.5342, Acc: 0.7300, AUC: 0.8236, F1: 0.5781
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 6/50
Train - Loss: 0.5134, Acc: 0.7362, AUC: 0.8150, F1: 0.6558
Val   - Loss: 0.5562, Acc: 0.7100, AUC: 0.8241, F1: 0.6742
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 7/50
Train - Loss: 0.5478, Acc: 0.7350, AUC: 0.8004, F1: 0.6667
Val   - Loss: 0.5579, Acc: 0.7400, AUC: 0.8130, F1: 0.6867
Epoch 8/50
Train - Loss: 0.5153, Acc: 0.7538, AUC: 0.8242, F1: 0.6807
Val   - Loss: 0.4872, Acc: 0.7750, AUC: 0.8533, F1: 0.7305
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 9/50
Train - Loss: 0.5044, Acc: 0.7675, AUC: 0.8280, F1: 0.7019
Val   - Loss: 0.5398, Acc: 0.7400, AUC: 0.8255, F1: 0.6232
Epoch 10/50
Train - Loss: 0.5188, Acc: 0.7600, AUC: 0.8200, F1: 0.6943
Val   - Loss: 0.5034, Acc: 0.7800, AUC: 0.8582, F1: 0.7528
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 11/50
Train - Loss: 0.4992, Acc: 0.7700, AUC: 0.8374, F1: 0.7079
Val   - Loss: 0.4912, Acc: 0.7700, AUC: 0.8528, F1: 0.7195
Epoch 12/50
Train - Loss: 0.5337, Acc: 0.7512, AUC: 0.8173, F1: 0.6895
Val   - Loss: 0.4986, Acc: 0.7650, AUC: 0.8500, F1: 0.6569
Epoch 13/50
Train - Loss: 0.5004, Acc: 0.7750, AUC: 0.8359, F1: 0.7161
Val   - Loss: 0.5678, Acc: 0.7550, AUC: 0.8147, F1: 0.6918
Epoch 14/50
Train - Loss: 0.4858, Acc: 0.7738, AUC: 0.8474, F1: 0.7159
Val   - Loss: 0.5553, Acc: 0.7350, AUC: 0.8353, F1: 0.7104
Epoch 15/50
Train - Loss: 0.4983, Acc: 0.7700, AUC: 0.8437, F1: 0.7061
Val   - Loss: 0.4886, Acc: 0.7850, AUC: 0.8437, F1: 0.7152
Early stopping triggered.
Model loaded successfully from ./models/rsna/attention/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.4320
Accuracy: 0.8000, AUC: 0.8625
Precision: 0.7838, Recall: 0.8056, F1-Score: 0.7945
Confusion Matrix:
[[62 16]
 [14 58]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
