rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.7148, Acc: 0.6400, AUC: 0.6472, F1: 0.5034
Val   - Loss: 0.7017, Acc: 0.4850, AUC: 0.7496, F1: 0.5961
Final model saved to ./models/rsna/max/model_max.pth
Epoch 2/50
Train - Loss: 0.5905, Acc: 0.7338, AUC: 0.7858, F1: 0.6491
Val   - Loss: 1.0425, Acc: 0.4500, AUC: 0.7678, F1: 0.5956
Final model saved to ./models/rsna/max/model_max.pth
Epoch 3/50
Train - Loss: 0.7307, Acc: 0.7462, AUC: 0.8047, F1: 0.6793
Val   - Loss: 0.7438, Acc: 0.5300, AUC: 0.7921, F1: 0.6299
Final model saved to ./models/rsna/max/model_max.pth
Epoch 4/50
Train - Loss: 0.4953, Acc: 0.7800, AUC: 0.8350, F1: 0.7215
Val   - Loss: 0.6006, Acc: 0.6700, AUC: 0.8078, F1: 0.6765
Final model saved to ./models/rsna/max/model_max.pth
Epoch 5/50
Train - Loss: 0.4634, Acc: 0.7913, AUC: 0.8570, F1: 0.7395
Val   - Loss: 0.5978, Acc: 0.6650, AUC: 0.8083, F1: 0.6732
Final model saved to ./models/rsna/max/model_max.pth
Epoch 6/50
Train - Loss: 0.4584, Acc: 0.7875, AUC: 0.8588, F1: 0.7360
Val   - Loss: 0.5359, Acc: 0.7750, AUC: 0.8181, F1: 0.7368
Final model saved to ./models/rsna/max/model_max.pth
Epoch 7/50
Train - Loss: 0.4265, Acc: 0.8013, AUC: 0.8802, F1: 0.7543
Val   - Loss: 0.6942, Acc: 0.5700, AUC: 0.8131, F1: 0.6417
Epoch 8/50
Train - Loss: 0.4373, Acc: 0.8150, AUC: 0.8748, F1: 0.7658
Val   - Loss: 0.6085, Acc: 0.6550, AUC: 0.8109, F1: 0.6761
Epoch 9/50
Train - Loss: 0.4264, Acc: 0.7850, AUC: 0.8806, F1: 0.7337
Val   - Loss: 0.6513, Acc: 0.6250, AUC: 0.8213, F1: 0.6637
Final model saved to ./models/rsna/max/model_max.pth
Epoch 10/50
Train - Loss: 0.3769, Acc: 0.8413, AUC: 0.9079, F1: 0.7987
Val   - Loss: 0.7792, Acc: 0.5500, AUC: 0.8182, F1: 0.6341
Epoch 11/50
Train - Loss: 0.3883, Acc: 0.8438, AUC: 0.9027, F1: 0.8050
Val   - Loss: 0.5475, Acc: 0.7300, AUC: 0.8255, F1: 0.7097
Final model saved to ./models/rsna/max/model_max.pth
Epoch 12/50
Train - Loss: 0.3866, Acc: 0.8225, AUC: 0.9026, F1: 0.7781
Val   - Loss: 0.7918, Acc: 0.5100, AUC: 0.8118, F1: 0.6080
Epoch 13/50
Train - Loss: 0.3843, Acc: 0.8275, AUC: 0.9034, F1: 0.7864
Val   - Loss: 0.5349, Acc: 0.7250, AUC: 0.8259, F1: 0.6927
Final model saved to ./models/rsna/max/model_max.pth
Epoch 14/50
Train - Loss: 0.3548, Acc: 0.8438, AUC: 0.9178, F1: 0.8019
Val   - Loss: 0.5978, Acc: 0.6750, AUC: 0.8215, F1: 0.6860
Epoch 15/50
Train - Loss: 0.3540, Acc: 0.8413, AUC: 0.9186, F1: 0.8049
Val   - Loss: 0.6781, Acc: 0.6700, AUC: 0.8193, F1: 0.7054
Epoch 16/50
Train - Loss: 0.3335, Acc: 0.8538, AUC: 0.9291, F1: 0.8157
Val   - Loss: 0.5926, Acc: 0.6900, AUC: 0.8268, F1: 0.6961
Final model saved to ./models/rsna/max/model_max.pth
Epoch 17/50
Train - Loss: 0.3276, Acc: 0.8600, AUC: 0.9306, F1: 0.8266
Val   - Loss: 0.5883, Acc: 0.7000, AUC: 0.8358, F1: 0.7000
Final model saved to ./models/rsna/max/model_max.pth
Epoch 18/50
Train - Loss: 0.3335, Acc: 0.8550, AUC: 0.9284, F1: 0.8204
Val   - Loss: 0.5670, Acc: 0.7200, AUC: 0.8315, F1: 0.7053
Epoch 19/50
Train - Loss: 0.3111, Acc: 0.8675, AUC: 0.9375, F1: 0.8354
Val   - Loss: 0.5166, Acc: 0.7550, AUC: 0.8326, F1: 0.7101
Epoch 20/50
Train - Loss: 0.3274, Acc: 0.8538, AUC: 0.9305, F1: 0.8163
Val   - Loss: 0.5509, Acc: 0.7250, AUC: 0.8300, F1: 0.6927
Epoch 21/50
Train - Loss: 0.3175, Acc: 0.8800, AUC: 0.9356, F1: 0.8519
Val   - Loss: 0.5876, Acc: 0.7050, AUC: 0.8220, F1: 0.6911
Epoch 22/50
Train - Loss: 0.2969, Acc: 0.8850, AUC: 0.9427, F1: 0.8580
Val   - Loss: 0.5048, Acc: 0.7700, AUC: 0.8340, F1: 0.7160
Early stopping triggered.
Model loaded successfully from ./models/rsna/max/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/max/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.4536
Accuracy: 0.8667, AUC: 0.9099
Precision: 0.8714, Recall: 0.8472, F1-Score: 0.8592
Confusion Matrix:
[[69  9]
 [11 61]]
