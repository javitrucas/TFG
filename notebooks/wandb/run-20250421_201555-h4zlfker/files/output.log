rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.6682, Acc: 0.5962, AUC: 0.5912, F1: 0.3752
Val   - Loss: 0.6254, Acc: 0.6950, AUC: 0.7223, F1: 0.5793
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 2/50
Train - Loss: 0.6153, Acc: 0.6813, AUC: 0.7084, F1: 0.5321
Val   - Loss: 0.6636, Acc: 0.5950, AUC: 0.7375, F1: 0.6267
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 3/50
Train - Loss: 0.5874, Acc: 0.6875, AUC: 0.7470, F1: 0.5675
Val   - Loss: 0.6655, Acc: 0.6050, AUC: 0.7562, F1: 0.0920
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 4/50
Train - Loss: 0.5638, Acc: 0.7100, AUC: 0.7676, F1: 0.6107
Val   - Loss: 0.5715, Acc: 0.7100, AUC: 0.7633, F1: 0.6081
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 5/50
Train - Loss: 0.5411, Acc: 0.7375, AUC: 0.7945, F1: 0.6453
Val   - Loss: 0.5590, Acc: 0.7200, AUC: 0.7806, F1: 0.6164
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 6/50
Train - Loss: 0.5230, Acc: 0.7388, AUC: 0.8105, F1: 0.6579
Val   - Loss: 0.5744, Acc: 0.6900, AUC: 0.7900, F1: 0.4833
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 7/50
Train - Loss: 0.5136, Acc: 0.7550, AUC: 0.8146, F1: 0.6722
Val   - Loss: 0.5434, Acc: 0.7300, AUC: 0.8013, F1: 0.6087
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 8/50
Train - Loss: 0.4985, Acc: 0.7600, AUC: 0.8289, F1: 0.6842
Val   - Loss: 0.5620, Acc: 0.6950, AUC: 0.8079, F1: 0.4959
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 9/50
Train - Loss: 0.4954, Acc: 0.7538, AUC: 0.8318, F1: 0.6722
Val   - Loss: 0.5267, Acc: 0.7400, AUC: 0.8126, F1: 0.6438
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 10/50
Train - Loss: 0.4881, Acc: 0.7638, AUC: 0.8379, F1: 0.6907
Val   - Loss: 0.5194, Acc: 0.7550, AUC: 0.8165, F1: 0.6918
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 11/50
Train - Loss: 0.4667, Acc: 0.7762, AUC: 0.8562, F1: 0.7118
Val   - Loss: 0.5198, Acc: 0.7600, AUC: 0.8205, F1: 0.7143
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 12/50
Train - Loss: 0.4642, Acc: 0.7725, AUC: 0.8547, F1: 0.7055
Val   - Loss: 0.5361, Acc: 0.7250, AUC: 0.8251, F1: 0.7027
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 13/50
Train - Loss: 0.4592, Acc: 0.7875, AUC: 0.8620, F1: 0.7258
Val   - Loss: 0.5422, Acc: 0.7250, AUC: 0.8270, F1: 0.7059
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 14/50
Train - Loss: 0.4668, Acc: 0.7812, AUC: 0.8559, F1: 0.7227
Val   - Loss: 0.5078, Acc: 0.7500, AUC: 0.8284, F1: 0.6479
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 15/50
Train - Loss: 0.4498, Acc: 0.7937, AUC: 0.8658, F1: 0.7360
Val   - Loss: 0.5661, Acc: 0.7000, AUC: 0.8313, F1: 0.4737
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 16/50
Train - Loss: 0.4335, Acc: 0.7987, AUC: 0.8779, F1: 0.7416
Val   - Loss: 0.4994, Acc: 0.7800, AUC: 0.8327, F1: 0.7317
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 17/50
Train - Loss: 0.4452, Acc: 0.7950, AUC: 0.8687, F1: 0.7380
Val   - Loss: 0.5996, Acc: 0.6950, AUC: 0.8355, F1: 0.4505
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 18/50
Train - Loss: 0.4425, Acc: 0.7913, AUC: 0.8688, F1: 0.7302
Val   - Loss: 0.5111, Acc: 0.7500, AUC: 0.8367, F1: 0.6324
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 19/50
Train - Loss: 0.4358, Acc: 0.7963, AUC: 0.8755, F1: 0.7392
Val   - Loss: 0.6461, Acc: 0.6750, AUC: 0.8374, F1: 0.7005
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 20/50
Train - Loss: 0.4300, Acc: 0.8063, AUC: 0.8776, F1: 0.7512
Val   - Loss: 0.5203, Acc: 0.7400, AUC: 0.8399, F1: 0.6119
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 21/50
Train - Loss: 0.4313, Acc: 0.8075, AUC: 0.8770, F1: 0.7540
Val   - Loss: 0.4864, Acc: 0.8000, AUC: 0.8415, F1: 0.7436
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 22/50
Train - Loss: 0.4231, Acc: 0.8050, AUC: 0.8827, F1: 0.7524
Val   - Loss: 0.5489, Acc: 0.7000, AUC: 0.8405, F1: 0.6939
Epoch 23/50
Train - Loss: 0.4082, Acc: 0.8163, AUC: 0.8908, F1: 0.7670
Val   - Loss: 0.4847, Acc: 0.8000, AUC: 0.8418, F1: 0.7333
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 24/50
Train - Loss: 0.4079, Acc: 0.8087, AUC: 0.8914, F1: 0.7591
Val   - Loss: 0.5167, Acc: 0.7450, AUC: 0.8425, F1: 0.6107
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 25/50
Train - Loss: 0.4107, Acc: 0.8213, AUC: 0.8924, F1: 0.7734
Val   - Loss: 0.4925, Acc: 0.7700, AUC: 0.8442, F1: 0.7326
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 26/50
Train - Loss: 0.4125, Acc: 0.8137, AUC: 0.8870, F1: 0.7654
Val   - Loss: 0.4922, Acc: 0.7700, AUC: 0.8450, F1: 0.6761
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 27/50
Train - Loss: 0.4095, Acc: 0.8037, AUC: 0.8904, F1: 0.7528
Val   - Loss: 0.5429, Acc: 0.7150, AUC: 0.8440, F1: 0.7047
Epoch 28/50
Train - Loss: 0.4154, Acc: 0.8113, AUC: 0.8860, F1: 0.7584
Val   - Loss: 0.4775, Acc: 0.8000, AUC: 0.8450, F1: 0.7436
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 29/50
Train - Loss: 0.3991, Acc: 0.8200, AUC: 0.8961, F1: 0.7707
Val   - Loss: 0.5750, Acc: 0.7300, AUC: 0.8451, F1: 0.5424
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 30/50
Train - Loss: 0.3978, Acc: 0.8225, AUC: 0.8965, F1: 0.7732
Val   - Loss: 0.4854, Acc: 0.7900, AUC: 0.8456, F1: 0.7162
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 31/50
Train - Loss: 0.4034, Acc: 0.8300, AUC: 0.8946, F1: 0.7855
Val   - Loss: 0.4752, Acc: 0.8000, AUC: 0.8465, F1: 0.7468
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 32/50
Train - Loss: 0.4010, Acc: 0.8275, AUC: 0.8960, F1: 0.7810
Val   - Loss: 0.5137, Acc: 0.7600, AUC: 0.8461, F1: 0.6418
Epoch 33/50
Train - Loss: 0.3898, Acc: 0.8325, AUC: 0.9036, F1: 0.7886
Val   - Loss: 0.5425, Acc: 0.7650, AUC: 0.8466, F1: 0.6299
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 34/50
Train - Loss: 0.3910, Acc: 0.8150, AUC: 0.9037, F1: 0.7636
Val   - Loss: 0.4886, Acc: 0.7700, AUC: 0.8465, F1: 0.7326
Epoch 35/50
Train - Loss: 0.3921, Acc: 0.8287, AUC: 0.9002, F1: 0.7896
Val   - Loss: 0.4729, Acc: 0.7900, AUC: 0.8476, F1: 0.7375
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 36/50
Train - Loss: 0.3876, Acc: 0.8313, AUC: 0.9043, F1: 0.7867
Val   - Loss: 0.4797, Acc: 0.8050, AUC: 0.8477, F1: 0.7417
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 37/50
Train - Loss: 0.3799, Acc: 0.8313, AUC: 0.9063, F1: 0.7874
Val   - Loss: 0.5103, Acc: 0.7750, AUC: 0.8496, F1: 0.6715
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 38/50
Train - Loss: 0.3923, Acc: 0.8237, AUC: 0.9009, F1: 0.7807
Val   - Loss: 0.4731, Acc: 0.8050, AUC: 0.8483, F1: 0.7607
Epoch 39/50
Train - Loss: 0.3898, Acc: 0.8275, AUC: 0.9025, F1: 0.7844
Val   - Loss: 0.4702, Acc: 0.8000, AUC: 0.8508, F1: 0.7436
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 40/50
Train - Loss: 0.3961, Acc: 0.8237, AUC: 0.8983, F1: 0.7793
Val   - Loss: 0.4713, Acc: 0.7950, AUC: 0.8499, F1: 0.7389
Epoch 41/50
Train - Loss: 0.3898, Acc: 0.8300, AUC: 0.9019, F1: 0.7848
Val   - Loss: 0.4819, Acc: 0.7800, AUC: 0.8494, F1: 0.7412
Epoch 42/50
Train - Loss: 0.3784, Acc: 0.8187, AUC: 0.9080, F1: 0.7724
Val   - Loss: 0.4734, Acc: 0.7950, AUC: 0.8497, F1: 0.7485
Epoch 43/50
Train - Loss: 0.3789, Acc: 0.8438, AUC: 0.9078, F1: 0.8044
Val   - Loss: 0.4702, Acc: 0.7950, AUC: 0.8514, F1: 0.7453
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 44/50
Train - Loss: 0.3728, Acc: 0.8287, AUC: 0.9103, F1: 0.7856
Val   - Loss: 0.5812, Acc: 0.7500, AUC: 0.8511, F1: 0.5902
Epoch 45/50
Train - Loss: 0.3691, Acc: 0.8400, AUC: 0.9121, F1: 0.7962
Val   - Loss: 0.5305, Acc: 0.7300, AUC: 0.8493, F1: 0.7128
Epoch 46/50
Train - Loss: 0.3696, Acc: 0.8363, AUC: 0.9136, F1: 0.7930
Val   - Loss: 0.4752, Acc: 0.8000, AUC: 0.8511, F1: 0.7368
Epoch 47/50
Train - Loss: 0.3787, Acc: 0.8200, AUC: 0.9073, F1: 0.7750
Val   - Loss: 0.4715, Acc: 0.7900, AUC: 0.8510, F1: 0.7308
Epoch 48/50
Train - Loss: 0.3674, Acc: 0.8413, AUC: 0.9126, F1: 0.7994
Val   - Loss: 0.4927, Acc: 0.7850, AUC: 0.8524, F1: 0.6993
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 49/50
Train - Loss: 0.3706, Acc: 0.8387, AUC: 0.9115, F1: 0.7962
Val   - Loss: 0.5641, Acc: 0.7750, AUC: 0.8530, F1: 0.6457
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 50/50
Train - Loss: 0.3649, Acc: 0.8438, AUC: 0.9155, F1: 0.8025
Val   - Loss: 0.4868, Acc: 0.7700, AUC: 0.8524, F1: 0.7326
Model loaded successfully from ./models/rsna/mean/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/mean/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.4362
Accuracy: 0.8533, AUC: 0.9136
Precision: 0.8205, Recall: 0.8889, F1-Score: 0.8533
Confusion Matrix:
[[64 14]
 [ 8 64]]
