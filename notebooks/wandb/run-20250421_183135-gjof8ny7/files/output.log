rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.6630, Acc: 0.6188, AUC: 0.6007, F1: 0.4101
Val   - Loss: 0.6551, Acc: 0.6150, AUC: 0.7039, F1: 0.6244
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 2/50
Train - Loss: 0.6075, Acc: 0.6900, AUC: 0.7264, F1: 0.5634
Val   - Loss: 0.5706, Acc: 0.7000, AUC: 0.7697, F1: 0.6000
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 3/50
Train - Loss: 0.5431, Acc: 0.7200, AUC: 0.7896, F1: 0.6242
Val   - Loss: 0.5616, Acc: 0.7200, AUC: 0.7964, F1: 0.6889
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 4/50
Train - Loss: 0.5367, Acc: 0.7412, AUC: 0.8052, F1: 0.6590
Val   - Loss: 0.6087, Acc: 0.6900, AUC: 0.7995, F1: 0.6931
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 5/50
Train - Loss: 0.4974, Acc: 0.7675, AUC: 0.8332, F1: 0.7029
Val   - Loss: 0.5503, Acc: 0.7100, AUC: 0.8023, F1: 0.5797
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 6/50
Train - Loss: 0.4906, Acc: 0.7788, AUC: 0.8380, F1: 0.7177
Val   - Loss: 0.5357, Acc: 0.7300, AUC: 0.8077, F1: 0.6824
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 7/50
Train - Loss: 0.4708, Acc: 0.7775, AUC: 0.8519, F1: 0.7129
Val   - Loss: 0.5219, Acc: 0.7200, AUC: 0.8182, F1: 0.6267
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 8/50
Train - Loss: 0.4726, Acc: 0.7863, AUC: 0.8489, F1: 0.7229
Val   - Loss: 0.5587, Acc: 0.7300, AUC: 0.8198, F1: 0.7033
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 9/50
Train - Loss: 0.4667, Acc: 0.8000, AUC: 0.8545, F1: 0.7460
Val   - Loss: 0.6100, Acc: 0.7150, AUC: 0.8278, F1: 0.7136
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 10/50
Train - Loss: 0.4500, Acc: 0.8050, AUC: 0.8643, F1: 0.7524
Val   - Loss: 0.5867, Acc: 0.7250, AUC: 0.8352, F1: 0.7120
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 11/50
Train - Loss: 0.4550, Acc: 0.7925, AUC: 0.8603, F1: 0.7314
Val   - Loss: 0.5009, Acc: 0.7500, AUC: 0.8363, F1: 0.7059
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 12/50
Train - Loss: 0.4383, Acc: 0.8075, AUC: 0.8739, F1: 0.7500
Val   - Loss: 0.5009, Acc: 0.7400, AUC: 0.8409, F1: 0.6977
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 13/50
Train - Loss: 0.4319, Acc: 0.8263, AUC: 0.8811, F1: 0.7783
Val   - Loss: 0.5075, Acc: 0.7500, AUC: 0.8382, F1: 0.7059
Epoch 14/50
Train - Loss: 0.4359, Acc: 0.7987, AUC: 0.8752, F1: 0.7504
Val   - Loss: 0.5159, Acc: 0.7550, AUC: 0.8490, F1: 0.6370
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 15/50
Train - Loss: 0.4108, Acc: 0.8175, AUC: 0.8926, F1: 0.7660
Val   - Loss: 0.4883, Acc: 0.7650, AUC: 0.8542, F1: 0.7283
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 16/50
Train - Loss: 0.4136, Acc: 0.8250, AUC: 0.8907, F1: 0.7764
Val   - Loss: 0.5289, Acc: 0.7650, AUC: 0.8517, F1: 0.7459
Epoch 17/50
Train - Loss: 0.3991, Acc: 0.8275, AUC: 0.8966, F1: 0.7816
Val   - Loss: 0.4985, Acc: 0.7700, AUC: 0.8498, F1: 0.6761
Epoch 18/50
Train - Loss: 0.4046, Acc: 0.8250, AUC: 0.8944, F1: 0.7799
Val   - Loss: 0.4871, Acc: 0.7900, AUC: 0.8523, F1: 0.7200
Epoch 19/50
Train - Loss: 0.3976, Acc: 0.8213, AUC: 0.8971, F1: 0.7734
Val   - Loss: 0.4648, Acc: 0.7750, AUC: 0.8636, F1: 0.6980
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 20/50
Train - Loss: 0.3859, Acc: 0.8363, AUC: 0.9029, F1: 0.7897
Val   - Loss: 0.4861, Acc: 0.7750, AUC: 0.8557, F1: 0.7337
Epoch 21/50
Train - Loss: 0.3776, Acc: 0.8475, AUC: 0.9077, F1: 0.8070
Val   - Loss: 0.4656, Acc: 0.7950, AUC: 0.8642, F1: 0.7285
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 22/50
Train - Loss: 0.3882, Acc: 0.8413, AUC: 0.9026, F1: 0.7987
Val   - Loss: 0.4907, Acc: 0.7600, AUC: 0.8611, F1: 0.7303
Epoch 23/50
Train - Loss: 0.3763, Acc: 0.8350, AUC: 0.9067, F1: 0.7925
Val   - Loss: 0.4676, Acc: 0.7850, AUC: 0.8709, F1: 0.7571
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 24/50
Train - Loss: 0.3638, Acc: 0.8538, AUC: 0.9156, F1: 0.8152
Val   - Loss: 0.4714, Acc: 0.7900, AUC: 0.8645, F1: 0.7407
Epoch 25/50
Train - Loss: 0.3714, Acc: 0.8512, AUC: 0.9119, F1: 0.8120
Val   - Loss: 0.4583, Acc: 0.7850, AUC: 0.8707, F1: 0.7456
Epoch 26/50
Train - Loss: 0.3546, Acc: 0.8500, AUC: 0.9173, F1: 0.8125
Val   - Loss: 0.4668, Acc: 0.7900, AUC: 0.8666, F1: 0.7407
Epoch 27/50
Train - Loss: 0.3569, Acc: 0.8500, AUC: 0.9181, F1: 0.8089
Val   - Loss: 0.5011, Acc: 0.7850, AUC: 0.8763, F1: 0.7749
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 28/50
Train - Loss: 0.3643, Acc: 0.8600, AUC: 0.9153, F1: 0.8266
Val   - Loss: 0.4745, Acc: 0.7800, AUC: 0.8698, F1: 0.6986
Epoch 29/50
Train - Loss: 0.3433, Acc: 0.8550, AUC: 0.9247, F1: 0.8176
Val   - Loss: 0.4793, Acc: 0.7700, AUC: 0.8663, F1: 0.6974
Epoch 30/50
Train - Loss: 0.3297, Acc: 0.8712, AUC: 0.9303, F1: 0.8368
Val   - Loss: 0.4926, Acc: 0.7800, AUC: 0.8707, F1: 0.7609
Epoch 31/50
Train - Loss: 0.3500, Acc: 0.8550, AUC: 0.9215, F1: 0.8187
Val   - Loss: 0.4871, Acc: 0.7950, AUC: 0.8692, F1: 0.7684
Epoch 32/50
Train - Loss: 0.3489, Acc: 0.8612, AUC: 0.9213, F1: 0.8235
Val   - Loss: 0.5041, Acc: 0.7750, AUC: 0.8678, F1: 0.7568
Early stopping triggered.
Model loaded successfully from ./models/rsna/attention/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.4075
Accuracy: 0.8067, AUC: 0.8818
Precision: 0.7590, Recall: 0.8750, F1-Score: 0.8129
Confusion Matrix:
[[58 20]
 [ 9 63]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
