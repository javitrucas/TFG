rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.6790, Acc: 0.5938, AUC: 0.5700, F1: 0.3615
Val   - Loss: 0.6451, Acc: 0.6050, AUC: 0.6724, F1: 0.5635
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 2/50
Train - Loss: 0.6280, Acc: 0.6288, AUC: 0.6801, F1: 0.4780
Val   - Loss: 0.6408, Acc: 0.6050, AUC: 0.7193, F1: 0.0920
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 3/50
Train - Loss: 0.5929, Acc: 0.7087, AUC: 0.7388, F1: 0.6058
Val   - Loss: 0.6089, Acc: 0.6350, AUC: 0.7499, F1: 0.2913
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 4/50
Train - Loss: 0.5742, Acc: 0.7163, AUC: 0.7596, F1: 0.6133
Val   - Loss: 0.5672, Acc: 0.7100, AUC: 0.7678, F1: 0.6234
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 5/50
Train - Loss: 0.5577, Acc: 0.7262, AUC: 0.7781, F1: 0.6473
Val   - Loss: 0.5534, Acc: 0.7050, AUC: 0.7881, F1: 0.5630
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 6/50
Train - Loss: 0.5549, Acc: 0.7188, AUC: 0.7789, F1: 0.6256
Val   - Loss: 0.5334, Acc: 0.7200, AUC: 0.8084, F1: 0.6056
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 7/50
Train - Loss: 0.5308, Acc: 0.7262, AUC: 0.8046, F1: 0.6380
Val   - Loss: 0.5175, Acc: 0.7250, AUC: 0.8198, F1: 0.6452
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 8/50
Train - Loss: 0.5136, Acc: 0.7562, AUC: 0.8157, F1: 0.6850
Val   - Loss: 0.5046, Acc: 0.7350, AUC: 0.8325, F1: 0.6624
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 9/50
Train - Loss: 0.5095, Acc: 0.7675, AUC: 0.8206, F1: 0.6941
Val   - Loss: 0.5241, Acc: 0.7250, AUC: 0.8423, F1: 0.5736
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 10/50
Train - Loss: 0.5042, Acc: 0.7625, AUC: 0.8241, F1: 0.6906
Val   - Loss: 0.4836, Acc: 0.7650, AUC: 0.8489, F1: 0.7081
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 11/50
Train - Loss: 0.4968, Acc: 0.7525, AUC: 0.8325, F1: 0.6827
Val   - Loss: 0.4985, Acc: 0.7750, AUC: 0.8556, F1: 0.7514
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 12/50
Train - Loss: 0.4960, Acc: 0.7625, AUC: 0.8338, F1: 0.6906
Val   - Loss: 0.4644, Acc: 0.7900, AUC: 0.8674, F1: 0.7407
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 13/50
Train - Loss: 0.4721, Acc: 0.7662, AUC: 0.8511, F1: 0.6929
Val   - Loss: 0.4565, Acc: 0.7750, AUC: 0.8702, F1: 0.6939
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 14/50
Train - Loss: 0.4739, Acc: 0.7825, AUC: 0.8498, F1: 0.7138
Val   - Loss: 0.5157, Acc: 0.7500, AUC: 0.8707, F1: 0.7475
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 15/50
Train - Loss: 0.4627, Acc: 0.7712, AUC: 0.8564, F1: 0.7053
Val   - Loss: 0.5096, Acc: 0.7500, AUC: 0.8740, F1: 0.7449
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 16/50
Train - Loss: 0.4606, Acc: 0.7837, AUC: 0.8590, F1: 0.7232
Val   - Loss: 0.4466, Acc: 0.8200, AUC: 0.8777, F1: 0.7831
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 17/50
Train - Loss: 0.4530, Acc: 0.7925, AUC: 0.8642, F1: 0.7331
Val   - Loss: 0.4745, Acc: 0.7650, AUC: 0.8816, F1: 0.7459
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 18/50
Train - Loss: 0.4507, Acc: 0.7875, AUC: 0.8645, F1: 0.7258
Val   - Loss: 0.4599, Acc: 0.8000, AUC: 0.8853, F1: 0.7753
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 19/50
Train - Loss: 0.4463, Acc: 0.8000, AUC: 0.8675, F1: 0.7452
Val   - Loss: 0.4980, Acc: 0.7700, AUC: 0.8849, F1: 0.7653
Epoch 20/50
Train - Loss: 0.4369, Acc: 0.7975, AUC: 0.8762, F1: 0.7461
Val   - Loss: 0.4442, Acc: 0.8050, AUC: 0.8892, F1: 0.7797
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 21/50
Train - Loss: 0.4380, Acc: 0.7963, AUC: 0.8744, F1: 0.7400
Val   - Loss: 0.4173, Acc: 0.8200, AUC: 0.8926, F1: 0.7662
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 22/50
Train - Loss: 0.4431, Acc: 0.8000, AUC: 0.8717, F1: 0.7419
Val   - Loss: 0.4727, Acc: 0.7800, AUC: 0.8932, F1: 0.7684
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 23/50
Train - Loss: 0.4294, Acc: 0.8037, AUC: 0.8787, F1: 0.7543
Val   - Loss: 0.4626, Acc: 0.7450, AUC: 0.8911, F1: 0.6165
Epoch 24/50
Train - Loss: 0.4390, Acc: 0.7950, AUC: 0.8749, F1: 0.7389
Val   - Loss: 0.4589, Acc: 0.7550, AUC: 0.8926, F1: 0.6423
Epoch 25/50
Train - Loss: 0.4324, Acc: 0.8013, AUC: 0.8764, F1: 0.7480
Val   - Loss: 0.4152, Acc: 0.8350, AUC: 0.8938, F1: 0.7898
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 26/50
Train - Loss: 0.4212, Acc: 0.8050, AUC: 0.8840, F1: 0.7516
Val   - Loss: 0.4315, Acc: 0.7750, AUC: 0.8949, F1: 0.6809
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 27/50
Train - Loss: 0.4144, Acc: 0.8187, AUC: 0.8884, F1: 0.7665
Val   - Loss: 0.6680, Acc: 0.6650, AUC: 0.8895, F1: 0.7048
Epoch 28/50
Train - Loss: 0.4216, Acc: 0.8100, AUC: 0.8830, F1: 0.7603
Val   - Loss: 0.4142, Acc: 0.7950, AUC: 0.8970, F1: 0.7211
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 29/50
Train - Loss: 0.4219, Acc: 0.8063, AUC: 0.8838, F1: 0.7551
Val   - Loss: 0.4199, Acc: 0.7850, AUC: 0.8964, F1: 0.7034
Epoch 30/50
Train - Loss: 0.4341, Acc: 0.8063, AUC: 0.8763, F1: 0.7528
Val   - Loss: 0.4581, Acc: 0.8050, AUC: 0.8916, F1: 0.7845
Epoch 31/50
Train - Loss: 0.4267, Acc: 0.8100, AUC: 0.8827, F1: 0.7572
Val   - Loss: 0.4125, Acc: 0.8250, AUC: 0.8960, F1: 0.7879
Epoch 32/50
Train - Loss: 0.4084, Acc: 0.8137, AUC: 0.8921, F1: 0.7639
Val   - Loss: 0.5398, Acc: 0.7550, AUC: 0.8982, F1: 0.7610
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 33/50
Train - Loss: 0.4278, Acc: 0.8013, AUC: 0.8804, F1: 0.7456
Val   - Loss: 0.4061, Acc: 0.8400, AUC: 0.8987, F1: 0.8025
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 34/50
Train - Loss: 0.4133, Acc: 0.8000, AUC: 0.8868, F1: 0.7484
Val   - Loss: 0.4265, Acc: 0.8300, AUC: 0.8982, F1: 0.8046
Epoch 35/50
Train - Loss: 0.4017, Acc: 0.8213, AUC: 0.8960, F1: 0.7762
Val   - Loss: 0.4076, Acc: 0.8250, AUC: 0.8990, F1: 0.7712
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 36/50
Train - Loss: 0.4013, Acc: 0.8250, AUC: 0.8959, F1: 0.7785
Val   - Loss: 0.4058, Acc: 0.8450, AUC: 0.8989, F1: 0.8025
Epoch 37/50
Train - Loss: 0.4054, Acc: 0.8213, AUC: 0.8924, F1: 0.7762
Val   - Loss: 0.5346, Acc: 0.7300, AUC: 0.9011, F1: 0.5500
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 38/50
Train - Loss: 0.3981, Acc: 0.8225, AUC: 0.8969, F1: 0.7724
Val   - Loss: 0.4582, Acc: 0.7500, AUC: 0.9003, F1: 0.6269
Epoch 39/50
Train - Loss: 0.4042, Acc: 0.8100, AUC: 0.8945, F1: 0.7564
Val   - Loss: 0.4162, Acc: 0.8400, AUC: 0.9019, F1: 0.8161
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 40/50
Train - Loss: 0.4105, Acc: 0.8137, AUC: 0.8909, F1: 0.7654
Val   - Loss: 0.3994, Acc: 0.8350, AUC: 0.9026, F1: 0.7975
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 41/50
Train - Loss: 0.3934, Acc: 0.8163, AUC: 0.9023, F1: 0.7648
Val   - Loss: 0.4139, Acc: 0.8400, AUC: 0.9013, F1: 0.8140
Epoch 42/50
Train - Loss: 0.4042, Acc: 0.8213, AUC: 0.8942, F1: 0.7712
Val   - Loss: 0.4138, Acc: 0.8350, AUC: 0.9001, F1: 0.8092
Epoch 43/50
Train - Loss: 0.3886, Acc: 0.8375, AUC: 0.9044, F1: 0.7956
Val   - Loss: 0.4873, Acc: 0.8000, AUC: 0.9008, F1: 0.7917
Epoch 44/50
Train - Loss: 0.4003, Acc: 0.8250, AUC: 0.8965, F1: 0.7792
Val   - Loss: 0.4544, Acc: 0.8300, AUC: 0.9032, F1: 0.8172
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 45/50
Train - Loss: 0.3907, Acc: 0.8363, AUC: 0.9009, F1: 0.7930
Val   - Loss: 0.4005, Acc: 0.8350, AUC: 0.9046, F1: 0.8070
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 46/50
Train - Loss: 0.3917, Acc: 0.8237, AUC: 0.9017, F1: 0.7758
Val   - Loss: 0.4438, Acc: 0.8400, AUC: 0.9035, F1: 0.8261
Epoch 47/50
Train - Loss: 0.3704, Acc: 0.8475, AUC: 0.9128, F1: 0.8076
Val   - Loss: 0.4750, Acc: 0.8100, AUC: 0.9027, F1: 0.8000
Epoch 48/50
Train - Loss: 0.3820, Acc: 0.8337, AUC: 0.9064, F1: 0.7938
Val   - Loss: 0.4366, Acc: 0.8350, AUC: 0.9033, F1: 0.8156
Epoch 49/50
Train - Loss: 0.4017, Acc: 0.8150, AUC: 0.8951, F1: 0.7673
Val   - Loss: 0.4273, Acc: 0.7650, AUC: 0.9045, F1: 0.6569
Epoch 50/50
Train - Loss: 0.3821, Acc: 0.8400, AUC: 0.9051, F1: 0.7949
Val   - Loss: 0.3975, Acc: 0.8400, AUC: 0.9042, F1: 0.8095
Early stopping triggered.
Model loaded successfully from ./models/rsna/mean/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/mean/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.5115
Accuracy: 0.8267, AUC: 0.9103
Precision: 0.8286, Recall: 0.8056, F1-Score: 0.8169
Confusion Matrix:
[[66 12]
 [14 58]]
