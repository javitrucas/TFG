rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.6676, Acc: 0.5800, AUC: 0.5848, F1: 0.2632
Val   - Loss: 0.6170, Acc: 0.6750, AUC: 0.7614, F1: 0.4444
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 2/50
Train - Loss: 0.6194, Acc: 0.6737, AUC: 0.7001, F1: 0.5193
Val   - Loss: 0.5881, Acc: 0.7300, AUC: 0.7760, F1: 0.6351
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 3/50
Train - Loss: 0.5886, Acc: 0.7037, AUC: 0.7488, F1: 0.5949
Val   - Loss: 0.5828, Acc: 0.6600, AUC: 0.7945, F1: 0.3585
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 4/50
Train - Loss: 0.5833, Acc: 0.6975, AUC: 0.7508, F1: 0.5870
Val   - Loss: 0.6088, Acc: 0.6350, AUC: 0.8094, F1: 0.2316
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 5/50
Train - Loss: 0.5508, Acc: 0.7238, AUC: 0.7849, F1: 0.6383
Val   - Loss: 0.5414, Acc: 0.7600, AUC: 0.8190, F1: 0.7073
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 6/50
Train - Loss: 0.5443, Acc: 0.7338, AUC: 0.7925, F1: 0.6444
Val   - Loss: 0.5487, Acc: 0.7750, AUC: 0.8228, F1: 0.7429
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 7/50
Train - Loss: 0.5331, Acc: 0.7425, AUC: 0.8031, F1: 0.6601
Val   - Loss: 0.5255, Acc: 0.7350, AUC: 0.8321, F1: 0.5891
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 8/50
Train - Loss: 0.5165, Acc: 0.7562, AUC: 0.8179, F1: 0.6745
Val   - Loss: 0.5077, Acc: 0.7800, AUC: 0.8330, F1: 0.7284
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 9/50
Train - Loss: 0.5088, Acc: 0.7562, AUC: 0.8207, F1: 0.6829
Val   - Loss: 0.4983, Acc: 0.7500, AUC: 0.8392, F1: 0.6622
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 10/50
Train - Loss: 0.4989, Acc: 0.7525, AUC: 0.8320, F1: 0.6722
Val   - Loss: 0.5003, Acc: 0.8000, AUC: 0.8446, F1: 0.7647
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 11/50
Train - Loss: 0.4841, Acc: 0.7550, AUC: 0.8425, F1: 0.6859
Val   - Loss: 0.4852, Acc: 0.7750, AUC: 0.8492, F1: 0.7020
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 12/50
Train - Loss: 0.4786, Acc: 0.7638, AUC: 0.8462, F1: 0.6907
Val   - Loss: 0.5752, Acc: 0.6800, AUC: 0.8546, F1: 0.3962
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 13/50
Train - Loss: 0.4740, Acc: 0.7650, AUC: 0.8489, F1: 0.6898
Val   - Loss: 0.5847, Acc: 0.7100, AUC: 0.8529, F1: 0.7238
Epoch 14/50
Train - Loss: 0.4665, Acc: 0.7738, AUC: 0.8551, F1: 0.7066
Val   - Loss: 0.4735, Acc: 0.7950, AUC: 0.8577, F1: 0.7485
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 15/50
Train - Loss: 0.4612, Acc: 0.7812, AUC: 0.8581, F1: 0.7182
Val   - Loss: 0.4712, Acc: 0.7900, AUC: 0.8578, F1: 0.7375
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 16/50
Train - Loss: 0.4536, Acc: 0.7863, AUC: 0.8629, F1: 0.7273
Val   - Loss: 0.4710, Acc: 0.7950, AUC: 0.8635, F1: 0.7574
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 17/50
Train - Loss: 0.4594, Acc: 0.7812, AUC: 0.8555, F1: 0.7164
Val   - Loss: 0.4644, Acc: 0.7800, AUC: 0.8655, F1: 0.6901
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 18/50
Train - Loss: 0.4561, Acc: 0.7887, AUC: 0.8630, F1: 0.7287
Val   - Loss: 0.5389, Acc: 0.7450, AUC: 0.8671, F1: 0.7463
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 19/50
Train - Loss: 0.4491, Acc: 0.7925, AUC: 0.8643, F1: 0.7357
Val   - Loss: 0.4584, Acc: 0.7950, AUC: 0.8677, F1: 0.7421
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 20/50
Train - Loss: 0.4346, Acc: 0.8000, AUC: 0.8771, F1: 0.7468
Val   - Loss: 0.4810, Acc: 0.7850, AUC: 0.8687, F1: 0.7543
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 21/50
Train - Loss: 0.4271, Acc: 0.8137, AUC: 0.8802, F1: 0.7577
Val   - Loss: 0.4571, Acc: 0.7900, AUC: 0.8690, F1: 0.7407
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 22/50
Train - Loss: 0.4368, Acc: 0.7987, AUC: 0.8749, F1: 0.7407
Val   - Loss: 0.5001, Acc: 0.7650, AUC: 0.8708, F1: 0.6466
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 23/50
Train - Loss: 0.4185, Acc: 0.7963, AUC: 0.8850, F1: 0.7392
Val   - Loss: 0.4967, Acc: 0.7650, AUC: 0.8738, F1: 0.6466
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 24/50
Train - Loss: 0.4270, Acc: 0.8063, AUC: 0.8815, F1: 0.7520
Val   - Loss: 0.4483, Acc: 0.7900, AUC: 0.8749, F1: 0.7342
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 25/50
Train - Loss: 0.4391, Acc: 0.7975, AUC: 0.8707, F1: 0.7420
Val   - Loss: 0.4591, Acc: 0.7900, AUC: 0.8784, F1: 0.7000
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 26/50
Train - Loss: 0.4210, Acc: 0.8100, AUC: 0.8846, F1: 0.7610
Val   - Loss: 0.4432, Acc: 0.8000, AUC: 0.8784, F1: 0.7333
Epoch 27/50
Train - Loss: 0.4172, Acc: 0.8000, AUC: 0.8881, F1: 0.7428
Val   - Loss: 0.4403, Acc: 0.8050, AUC: 0.8807, F1: 0.7383
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 28/50
Train - Loss: 0.4120, Acc: 0.8150, AUC: 0.8914, F1: 0.7680
Val   - Loss: 0.6505, Acc: 0.7000, AUC: 0.8838, F1: 0.4545
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 29/50
Train - Loss: 0.4184, Acc: 0.8287, AUC: 0.8865, F1: 0.7794
Val   - Loss: 0.4523, Acc: 0.8050, AUC: 0.8802, F1: 0.7665
Epoch 30/50
Train - Loss: 0.4156, Acc: 0.8137, AUC: 0.8872, F1: 0.7668
Val   - Loss: 0.4633, Acc: 0.7900, AUC: 0.8839, F1: 0.6912
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 31/50
Train - Loss: 0.3979, Acc: 0.8300, AUC: 0.8989, F1: 0.7834
Val   - Loss: 0.4713, Acc: 0.7900, AUC: 0.8848, F1: 0.6912
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 32/50
Train - Loss: 0.4039, Acc: 0.8137, AUC: 0.8946, F1: 0.7616
Val   - Loss: 0.5542, Acc: 0.7450, AUC: 0.8836, F1: 0.5854
Epoch 33/50
Train - Loss: 0.4033, Acc: 0.8200, AUC: 0.8950, F1: 0.7729
Val   - Loss: 0.5517, Acc: 0.7500, AUC: 0.8817, F1: 0.6032
Epoch 34/50
Train - Loss: 0.4002, Acc: 0.8063, AUC: 0.8968, F1: 0.7551
Val   - Loss: 0.4470, Acc: 0.7950, AUC: 0.8808, F1: 0.7485
Epoch 35/50
Train - Loss: 0.3980, Acc: 0.8350, AUC: 0.8970, F1: 0.7905
Val   - Loss: 0.5616, Acc: 0.7450, AUC: 0.8857, F1: 0.5854
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 36/50
Train - Loss: 0.4000, Acc: 0.8313, AUC: 0.8986, F1: 0.7887
Val   - Loss: 0.4864, Acc: 0.7900, AUC: 0.8856, F1: 0.6866
Epoch 37/50
Train - Loss: 0.3966, Acc: 0.8337, AUC: 0.8977, F1: 0.7906
Val   - Loss: 0.5074, Acc: 0.7700, AUC: 0.8844, F1: 0.6462
Epoch 38/50
Train - Loss: 0.3951, Acc: 0.8150, AUC: 0.8985, F1: 0.7636
Val   - Loss: 0.5419, Acc: 0.7550, AUC: 0.8803, F1: 0.7538
Epoch 39/50
Train - Loss: 0.3971, Acc: 0.8187, AUC: 0.8991, F1: 0.7709
Val   - Loss: 0.4342, Acc: 0.8200, AUC: 0.8860, F1: 0.7600
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 40/50
Train - Loss: 0.3927, Acc: 0.8275, AUC: 0.8998, F1: 0.7837
Val   - Loss: 0.4638, Acc: 0.7950, AUC: 0.8818, F1: 0.7602
Epoch 41/50
Train - Loss: 0.3762, Acc: 0.8413, AUC: 0.9107, F1: 0.8000
Val   - Loss: 0.4497, Acc: 0.8150, AUC: 0.8821, F1: 0.7448
Epoch 42/50
Train - Loss: 0.3850, Acc: 0.8237, AUC: 0.9050, F1: 0.7773
Val   - Loss: 0.4398, Acc: 0.7950, AUC: 0.8817, F1: 0.7421
Epoch 43/50
Train - Loss: 0.3846, Acc: 0.8250, AUC: 0.9046, F1: 0.7785
Val   - Loss: 0.4351, Acc: 0.8050, AUC: 0.8847, F1: 0.7484
Epoch 44/50
Train - Loss: 0.3915, Acc: 0.8263, AUC: 0.9014, F1: 0.7818
Val   - Loss: 0.4326, Acc: 0.8200, AUC: 0.8854, F1: 0.7600
Early stopping triggered.
Model loaded successfully from ./models/rsna/mean/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/mean/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.3769
Accuracy: 0.8467, AUC: 0.9151
Precision: 0.8267, Recall: 0.8611, F1-Score: 0.8435
Confusion Matrix:
[[65 13]
 [10 62]]
