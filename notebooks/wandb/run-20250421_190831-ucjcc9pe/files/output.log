rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.7302, Acc: 0.6075, AUC: 0.5822, F1: 0.4413
Val   - Loss: 0.6307, Acc: 0.6800, AUC: 0.7662, F1: 0.6832
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 2/50
Train - Loss: 0.6280, Acc: 0.6650, AUC: 0.6884, F1: 0.5442
Val   - Loss: 0.5619, Acc: 0.7350, AUC: 0.7918, F1: 0.6901
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 3/50
Train - Loss: 0.5824, Acc: 0.6837, AUC: 0.7501, F1: 0.5990
Val   - Loss: 0.7605, Acc: 0.5200, AUC: 0.8095, F1: 0.6308
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 4/50
Train - Loss: 0.5639, Acc: 0.7113, AUC: 0.7730, F1: 0.6339
Val   - Loss: 0.6937, Acc: 0.6000, AUC: 0.8072, F1: 0.0476
Epoch 5/50
Train - Loss: 0.5357, Acc: 0.7362, AUC: 0.7974, F1: 0.6602
Val   - Loss: 0.5677, Acc: 0.6950, AUC: 0.8206, F1: 0.4874
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 6/50
Train - Loss: 0.5356, Acc: 0.7300, AUC: 0.8023, F1: 0.6516
Val   - Loss: 0.5323, Acc: 0.7150, AUC: 0.8186, F1: 0.5581
Epoch 7/50
Train - Loss: 0.4814, Acc: 0.7688, AUC: 0.8473, F1: 0.7049
Val   - Loss: 0.5147, Acc: 0.7400, AUC: 0.8205, F1: 0.6389
Epoch 8/50
Train - Loss: 0.4966, Acc: 0.7538, AUC: 0.8320, F1: 0.6858
Val   - Loss: 0.5428, Acc: 0.7350, AUC: 0.8174, F1: 0.7039
Epoch 9/50
Train - Loss: 0.5068, Acc: 0.7625, AUC: 0.8295, F1: 0.6955
Val   - Loss: 0.5325, Acc: 0.7300, AUC: 0.8195, F1: 0.6029
Epoch 10/50
Train - Loss: 0.4959, Acc: 0.7562, AUC: 0.8357, F1: 0.6860
Val   - Loss: 0.6265, Acc: 0.7050, AUC: 0.8224, F1: 0.4957
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 11/50
Train - Loss: 0.4602, Acc: 0.7913, AUC: 0.8607, F1: 0.7370
Val   - Loss: 0.5962, Acc: 0.7150, AUC: 0.8209, F1: 0.5366
Epoch 12/50
Train - Loss: 0.4433, Acc: 0.7963, AUC: 0.8720, F1: 0.7400
Val   - Loss: 0.5852, Acc: 0.7100, AUC: 0.8239, F1: 0.5397
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 13/50
Train - Loss: 0.5026, Acc: 0.7788, AUC: 0.8494, F1: 0.7247
Val   - Loss: 0.5376, Acc: 0.7100, AUC: 0.8232, F1: 0.5606
Epoch 14/50
Train - Loss: 0.4479, Acc: 0.7900, AUC: 0.8698, F1: 0.7375
Val   - Loss: 0.5423, Acc: 0.7450, AUC: 0.8122, F1: 0.6871
Epoch 15/50
Train - Loss: 0.4292, Acc: 0.8113, AUC: 0.8812, F1: 0.7652
Val   - Loss: 0.5215, Acc: 0.7400, AUC: 0.8241, F1: 0.6750
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 16/50
Train - Loss: 0.4301, Acc: 0.8087, AUC: 0.8769, F1: 0.7583
Val   - Loss: 0.5921, Acc: 0.7150, AUC: 0.8252, F1: 0.5512
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 17/50
Train - Loss: 0.4673, Acc: 0.7937, AUC: 0.8680, F1: 0.7410
Val   - Loss: 0.5221, Acc: 0.7500, AUC: 0.8261, F1: 0.6667
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 18/50
Train - Loss: 0.4224, Acc: 0.8087, AUC: 0.8852, F1: 0.7591
Val   - Loss: 0.5664, Acc: 0.7500, AUC: 0.8276, F1: 0.7253
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 19/50
Train - Loss: 0.4372, Acc: 0.8187, AUC: 0.8783, F1: 0.7731
Val   - Loss: 0.5648, Acc: 0.7350, AUC: 0.8221, F1: 0.7104
Epoch 20/50
Train - Loss: 0.4109, Acc: 0.8150, AUC: 0.8909, F1: 0.7695
Val   - Loss: 0.6224, Acc: 0.7200, AUC: 0.8285, F1: 0.5484
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 21/50
Train - Loss: 0.4481, Acc: 0.8050, AUC: 0.8742, F1: 0.7539
Val   - Loss: 0.7247, Acc: 0.6350, AUC: 0.8283, F1: 0.6840
Epoch 22/50
Train - Loss: 0.4177, Acc: 0.8113, AUC: 0.8872, F1: 0.7622
Val   - Loss: 0.6694, Acc: 0.6500, AUC: 0.8234, F1: 0.6847
Epoch 23/50
Train - Loss: 0.3872, Acc: 0.8237, AUC: 0.9031, F1: 0.7793
Val   - Loss: 0.6104, Acc: 0.7350, AUC: 0.8288, F1: 0.7310
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 24/50
Train - Loss: 0.4260, Acc: 0.8175, AUC: 0.8828, F1: 0.7704
Val   - Loss: 0.7255, Acc: 0.6950, AUC: 0.8271, F1: 0.4602
Epoch 25/50
Train - Loss: 0.4087, Acc: 0.8175, AUC: 0.8968, F1: 0.7733
Val   - Loss: 0.7065, Acc: 0.7050, AUC: 0.8288, F1: 0.4957
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 26/50
Train - Loss: 0.4175, Acc: 0.8063, AUC: 0.8893, F1: 0.7574
Val   - Loss: 0.5487, Acc: 0.7600, AUC: 0.8304, F1: 0.7108
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 27/50
Train - Loss: 0.4174, Acc: 0.8275, AUC: 0.8926, F1: 0.7850
Val   - Loss: 0.5266, Acc: 0.7450, AUC: 0.8296, F1: 0.6667
Epoch 28/50
Train - Loss: 0.4118, Acc: 0.8187, AUC: 0.8894, F1: 0.7745
Val   - Loss: 0.7266, Acc: 0.6700, AUC: 0.8330, F1: 0.6972
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 29/50
Train - Loss: 0.4016, Acc: 0.8400, AUC: 0.9005, F1: 0.8012
Val   - Loss: 0.6418, Acc: 0.6950, AUC: 0.8322, F1: 0.7109
Epoch 30/50
Train - Loss: 0.3973, Acc: 0.8237, AUC: 0.8974, F1: 0.7773
Val   - Loss: 0.6138, Acc: 0.7300, AUC: 0.8322, F1: 0.5645
Epoch 31/50
Train - Loss: 0.3984, Acc: 0.8300, AUC: 0.8988, F1: 0.7868
Val   - Loss: 0.6243, Acc: 0.7250, AUC: 0.8312, F1: 0.5455
Epoch 32/50
Train - Loss: 0.3988, Acc: 0.8325, AUC: 0.8974, F1: 0.7873
Val   - Loss: 0.5860, Acc: 0.7300, AUC: 0.8325, F1: 0.5781
Epoch 33/50
Train - Loss: 0.4064, Acc: 0.8150, AUC: 0.8960, F1: 0.7666
Val   - Loss: 0.5532, Acc: 0.7400, AUC: 0.8333, F1: 0.7079
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 34/50
Train - Loss: 0.4434, Acc: 0.8087, AUC: 0.8746, F1: 0.7583
Val   - Loss: 0.5210, Acc: 0.7550, AUC: 0.8345, F1: 0.6839
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 35/50
Train - Loss: 0.3832, Acc: 0.8300, AUC: 0.9042, F1: 0.7848
Val   - Loss: 0.5760, Acc: 0.7650, AUC: 0.8319, F1: 0.7487
Epoch 36/50
Train - Loss: 0.4038, Acc: 0.8275, AUC: 0.8953, F1: 0.7837
Val   - Loss: 0.5894, Acc: 0.7400, AUC: 0.8268, F1: 0.7111
Epoch 37/50
Train - Loss: 0.3795, Acc: 0.8400, AUC: 0.9067, F1: 0.8025
Val   - Loss: 0.5389, Acc: 0.7400, AUC: 0.8332, F1: 0.6438
Epoch 38/50
Train - Loss: 0.3954, Acc: 0.8213, AUC: 0.8985, F1: 0.7783
Val   - Loss: 0.5539, Acc: 0.7550, AUC: 0.8328, F1: 0.7135
Epoch 39/50
Train - Loss: 0.3755, Acc: 0.8350, AUC: 0.9089, F1: 0.7925
Val   - Loss: 0.6530, Acc: 0.7500, AUC: 0.8264, F1: 0.7475
Early stopping triggered.
Model loaded successfully from ./models/rsna/mean/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/mean/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.8480
Accuracy: 0.8400, AUC: 0.9094
Precision: 0.9000, Recall: 0.7500, F1-Score: 0.8182
Confusion Matrix:
[[72  6]
 [18 54]]
