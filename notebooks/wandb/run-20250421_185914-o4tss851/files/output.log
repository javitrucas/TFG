rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.6945, Acc: 0.6200, AUC: 0.6403, F1: 0.4899
Val   - Loss: 0.6249, Acc: 0.6700, AUC: 0.7446, F1: 0.6562
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 2/50
Train - Loss: 0.6126, Acc: 0.6562, AUC: 0.7041, F1: 0.5315
Val   - Loss: 0.5825, Acc: 0.7200, AUC: 0.7565, F1: 0.6667
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 3/50
Train - Loss: 0.5790, Acc: 0.7013, AUC: 0.7578, F1: 0.6063
Val   - Loss: 0.5602, Acc: 0.7250, AUC: 0.7734, F1: 0.6452
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 4/50
Train - Loss: 0.5602, Acc: 0.7137, AUC: 0.7754, F1: 0.6276
Val   - Loss: 0.6619, Acc: 0.6200, AUC: 0.7941, F1: 0.1739
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 5/50
Train - Loss: 0.5430, Acc: 0.7200, AUC: 0.7900, F1: 0.6304
Val   - Loss: 0.6002, Acc: 0.6700, AUC: 0.8076, F1: 0.3529
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 6/50
Train - Loss: 0.5260, Acc: 0.7375, AUC: 0.8039, F1: 0.6535
Val   - Loss: 0.5954, Acc: 0.6800, AUC: 0.8140, F1: 0.4286
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 7/50
Train - Loss: 0.5084, Acc: 0.7600, AUC: 0.8199, F1: 0.6962
Val   - Loss: 0.7254, Acc: 0.6300, AUC: 0.8163, F1: 0.2128
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 8/50
Train - Loss: 0.5131, Acc: 0.7438, AUC: 0.8154, F1: 0.6720
Val   - Loss: 0.8055, Acc: 0.6300, AUC: 0.8238, F1: 0.2128
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 9/50
Train - Loss: 0.5067, Acc: 0.7525, AUC: 0.8268, F1: 0.6837
Val   - Loss: 0.5149, Acc: 0.7400, AUC: 0.8261, F1: 0.6338
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 10/50
Train - Loss: 0.4758, Acc: 0.7700, AUC: 0.8494, F1: 0.7003
Val   - Loss: 0.5236, Acc: 0.7350, AUC: 0.8286, F1: 0.7072
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 11/50
Train - Loss: 0.4881, Acc: 0.7600, AUC: 0.8414, F1: 0.6893
Val   - Loss: 0.5097, Acc: 0.7400, AUC: 0.8324, F1: 0.7079
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 12/50
Train - Loss: 0.4806, Acc: 0.7750, AUC: 0.8458, F1: 0.7125
Val   - Loss: 0.5450, Acc: 0.6900, AUC: 0.8372, F1: 0.4464
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 13/50
Train - Loss: 0.4690, Acc: 0.7825, AUC: 0.8518, F1: 0.7247
Val   - Loss: 0.5991, Acc: 0.6800, AUC: 0.8367, F1: 0.6863
Epoch 14/50
Train - Loss: 0.4496, Acc: 0.8025, AUC: 0.8664, F1: 0.7476
Val   - Loss: 0.5855, Acc: 0.6800, AUC: 0.8386, F1: 0.6863
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 15/50
Train - Loss: 0.4742, Acc: 0.7887, AUC: 0.8499, F1: 0.7388
Val   - Loss: 0.5617, Acc: 0.6950, AUC: 0.8416, F1: 0.4602
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 16/50
Train - Loss: 0.4441, Acc: 0.7913, AUC: 0.8702, F1: 0.7311
Val   - Loss: 0.6001, Acc: 0.6800, AUC: 0.8416, F1: 0.6952
Epoch 17/50
Train - Loss: 0.4487, Acc: 0.7800, AUC: 0.8657, F1: 0.7241
Val   - Loss: 0.5028, Acc: 0.7450, AUC: 0.8438, F1: 0.7182
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 18/50
Train - Loss: 0.4612, Acc: 0.7863, AUC: 0.8593, F1: 0.7307
Val   - Loss: 0.5150, Acc: 0.7400, AUC: 0.8425, F1: 0.7174
Epoch 19/50
Train - Loss: 0.4342, Acc: 0.8013, AUC: 0.8773, F1: 0.7456
Val   - Loss: 0.4819, Acc: 0.8100, AUC: 0.8429, F1: 0.7595
Epoch 20/50
Train - Loss: 0.4480, Acc: 0.7963, AUC: 0.8690, F1: 0.7433
Val   - Loss: 0.5507, Acc: 0.7000, AUC: 0.8434, F1: 0.6939
Epoch 21/50
Train - Loss: 0.4399, Acc: 0.7887, AUC: 0.8730, F1: 0.7355
Val   - Loss: 0.4851, Acc: 0.7800, AUC: 0.8447, F1: 0.6944
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 22/50
Train - Loss: 0.4158, Acc: 0.8113, AUC: 0.8880, F1: 0.7607
Val   - Loss: 0.5090, Acc: 0.7700, AUC: 0.8418, F1: 0.6714
Epoch 23/50
Train - Loss: 0.4390, Acc: 0.8087, AUC: 0.8734, F1: 0.7591
Val   - Loss: 0.5162, Acc: 0.7550, AUC: 0.8481, F1: 0.6202
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 24/50
Train - Loss: 0.4149, Acc: 0.8113, AUC: 0.8896, F1: 0.7607
Val   - Loss: 0.5348, Acc: 0.7250, AUC: 0.8474, F1: 0.7090
Epoch 25/50
Train - Loss: 0.4187, Acc: 0.8237, AUC: 0.8865, F1: 0.7744
Val   - Loss: 0.5084, Acc: 0.7400, AUC: 0.8475, F1: 0.7174
Epoch 26/50
Train - Loss: 0.4126, Acc: 0.8087, AUC: 0.8882, F1: 0.7583
Val   - Loss: 0.5358, Acc: 0.7250, AUC: 0.8487, F1: 0.7120
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 27/50
Train - Loss: 0.4262, Acc: 0.7975, AUC: 0.8822, F1: 0.7429
Val   - Loss: 0.4756, Acc: 0.7900, AUC: 0.8493, F1: 0.7500
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 28/50
Train - Loss: 0.4245, Acc: 0.8050, AUC: 0.8804, F1: 0.7555
Val   - Loss: 0.5472, Acc: 0.7050, AUC: 0.8468, F1: 0.6974
Epoch 29/50
Train - Loss: 0.4265, Acc: 0.8113, AUC: 0.8834, F1: 0.7607
Val   - Loss: 0.6385, Acc: 0.7100, AUC: 0.8513, F1: 0.4912
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 30/50
Train - Loss: 0.4092, Acc: 0.8175, AUC: 0.8917, F1: 0.7653
Val   - Loss: 0.4975, Acc: 0.7650, AUC: 0.8465, F1: 0.7283
Epoch 31/50
Train - Loss: 0.4051, Acc: 0.8287, AUC: 0.8949, F1: 0.7849
Val   - Loss: 0.6859, Acc: 0.7050, AUC: 0.8451, F1: 0.4685
Epoch 32/50
Train - Loss: 0.4082, Acc: 0.8037, AUC: 0.8907, F1: 0.7512
Val   - Loss: 0.5444, Acc: 0.7700, AUC: 0.8487, F1: 0.6462
Epoch 33/50
Train - Loss: 0.4153, Acc: 0.8225, AUC: 0.8875, F1: 0.7717
Val   - Loss: 0.4736, Acc: 0.8000, AUC: 0.8508, F1: 0.7403
Epoch 34/50
Train - Loss: 0.4130, Acc: 0.8287, AUC: 0.8913, F1: 0.7849
Val   - Loss: 0.5187, Acc: 0.7750, AUC: 0.8502, F1: 0.6667
Early stopping triggered.
Model loaded successfully from ./models/rsna/mean/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/mean/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.1904
Accuracy: 0.8600, AUC: 0.9168
Precision: 0.8400, Recall: 0.8750, F1-Score: 0.8571
Confusion Matrix:
[[66 12]
 [ 9 63]]
