rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.7514, Acc: 0.6100, AUC: 0.6222, F1: 0.4157
Val   - Loss: 0.6316, Acc: 0.7050, AUC: 0.7323, F1: 0.6040
Final model saved to ./models/rsna/max/model_max.pth
Epoch 2/50
Train - Loss: 0.6432, Acc: 0.6913, AUC: 0.7513, F1: 0.5849
Val   - Loss: 0.5843, Acc: 0.6900, AUC: 0.7863, F1: 0.4918
Final model saved to ./models/rsna/max/model_max.pth
Epoch 3/50
Train - Loss: 0.5520, Acc: 0.7375, AUC: 0.7994, F1: 0.6441
Val   - Loss: 0.5733, Acc: 0.7350, AUC: 0.8028, F1: 0.6971
Final model saved to ./models/rsna/max/model_max.pth
Epoch 4/50
Train - Loss: 0.5224, Acc: 0.7412, AUC: 0.8080, F1: 0.6623
Val   - Loss: 0.5467, Acc: 0.7250, AUC: 0.8247, F1: 0.6405
Final model saved to ./models/rsna/max/model_max.pth
Epoch 5/50
Train - Loss: 0.4718, Acc: 0.7812, AUC: 0.8478, F1: 0.7200
Val   - Loss: 0.6405, Acc: 0.6350, AUC: 0.8324, F1: 0.6840
Final model saved to ./models/rsna/max/model_max.pth
Epoch 6/50
Train - Loss: 0.4655, Acc: 0.7775, AUC: 0.8555, F1: 0.7184
Val   - Loss: 0.5527, Acc: 0.7400, AUC: 0.8377, F1: 0.7320
Final model saved to ./models/rsna/max/model_max.pth
Epoch 7/50
Train - Loss: 0.4612, Acc: 0.7738, AUC: 0.8558, F1: 0.7113
Val   - Loss: 0.5386, Acc: 0.7550, AUC: 0.8437, F1: 0.7351
Final model saved to ./models/rsna/max/model_max.pth
Epoch 8/50
Train - Loss: 0.4607, Acc: 0.7837, AUC: 0.8577, F1: 0.7276
Val   - Loss: 0.5152, Acc: 0.7700, AUC: 0.8433, F1: 0.7229
Epoch 9/50
Train - Loss: 0.4467, Acc: 0.8050, AUC: 0.8664, F1: 0.7555
Val   - Loss: 0.5046, Acc: 0.7550, AUC: 0.8465, F1: 0.6667
Final model saved to ./models/rsna/max/model_max.pth
Epoch 10/50
Train - Loss: 0.4280, Acc: 0.7975, AUC: 0.8803, F1: 0.7445
Val   - Loss: 0.5116, Acc: 0.7600, AUC: 0.8444, F1: 0.7108
Epoch 11/50
Train - Loss: 0.4177, Acc: 0.8250, AUC: 0.8849, F1: 0.7792
Val   - Loss: 0.5696, Acc: 0.6800, AUC: 0.8532, F1: 0.7009
Final model saved to ./models/rsna/max/model_max.pth
Epoch 12/50
Train - Loss: 0.4145, Acc: 0.8075, AUC: 0.8872, F1: 0.7594
Val   - Loss: 0.5104, Acc: 0.8050, AUC: 0.8501, F1: 0.7719
Epoch 13/50
Train - Loss: 0.4082, Acc: 0.8325, AUC: 0.8919, F1: 0.7906
Val   - Loss: 0.4921, Acc: 0.7700, AUC: 0.8537, F1: 0.6933
Final model saved to ./models/rsna/max/model_max.pth
Epoch 14/50
Train - Loss: 0.4095, Acc: 0.8137, AUC: 0.8895, F1: 0.7608
Val   - Loss: 0.5909, Acc: 0.6750, AUC: 0.8521, F1: 0.7005
Epoch 15/50
Train - Loss: 0.4088, Acc: 0.8100, AUC: 0.8902, F1: 0.7654
Val   - Loss: 0.6103, Acc: 0.6600, AUC: 0.8573, F1: 0.6964
Final model saved to ./models/rsna/max/model_max.pth
Epoch 16/50
Train - Loss: 0.3984, Acc: 0.8300, AUC: 0.8981, F1: 0.7848
Val   - Loss: 0.5186, Acc: 0.7600, AUC: 0.8516, F1: 0.7391
Epoch 17/50
Train - Loss: 0.3791, Acc: 0.8313, AUC: 0.9078, F1: 0.7881
Val   - Loss: 0.4833, Acc: 0.7900, AUC: 0.8527, F1: 0.7375
Epoch 18/50
Train - Loss: 0.3829, Acc: 0.8400, AUC: 0.9024, F1: 0.8012
Val   - Loss: 0.5207, Acc: 0.7450, AUC: 0.8551, F1: 0.7358
Epoch 19/50
Train - Loss: 0.3796, Acc: 0.8363, AUC: 0.9041, F1: 0.7904
Val   - Loss: 0.4756, Acc: 0.7950, AUC: 0.8548, F1: 0.7389
Epoch 20/50
Train - Loss: 0.3732, Acc: 0.8325, AUC: 0.9101, F1: 0.7866
Val   - Loss: 0.6994, Acc: 0.5950, AUC: 0.8524, F1: 0.6582
Early stopping triggered.
Model loaded successfully from ./models/rsna/max/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/max/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.7209
Accuracy: 0.8267, AUC: 0.8882
Precision: 0.7805, Recall: 0.8889, F1-Score: 0.8312
Confusion Matrix:
[[60 18]
 [ 8 64]]
