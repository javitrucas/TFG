panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|██████████| 8822/8822 [01:45<00:00, 83.39it/s]
[WSIDataset] Building data dict: 100%|██████████| 1794/1794 [00:19<00:00, 93.34it/s] 
[WSIDataset] Skipped 5 bags
[WSIDataset] Found 8817 already processed bags
panda
[WSIDataset] Scanning files...
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
[WSIDataset] Skipped 0 bags
[WSIDataset] Found 1794 already processed bags
Epoch 1/15
Train - Loss: 0.2119, Acc: 0.9179, AUC: 0.9685, F1: 0.9437
Val   - Loss: 0.1572, Acc: 0.9427, AUC: 0.9840, F1: 0.9613
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 2/15
Train - Loss: 0.1853, Acc: 0.9324, AUC: 0.9771, F1: 0.9535
Val   - Loss: 0.1352, Acc: 0.9473, AUC: 0.9853, F1: 0.9635
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 3/15
Train - Loss: 0.1683, Acc: 0.9406, AUC: 0.9818, F1: 0.9592
Val   - Loss: 0.1987, Acc: 0.9467, AUC: 0.9825, F1: 0.9627
Epoch 4/15
Train - Loss: 0.1828, Acc: 0.9346, AUC: 0.9801, F1: 0.9551
Val   - Loss: 0.1495, Acc: 0.9546, AUC: 0.9852, F1: 0.9690
Epoch 5/15
Train - Loss: 0.1832, Acc: 0.9402, AUC: 0.9810, F1: 0.9589
Val   - Loss: 0.1771, Acc: 0.9478, AUC: 0.9837, F1: 0.9641
Epoch 6/15
Train - Loss: 0.1765, Acc: 0.9409, AUC: 0.9826, F1: 0.9593
Val   - Loss: 0.1724, Acc: 0.9427, AUC: 0.9818, F1: 0.9608
Epoch 7/15
Train - Loss: 0.1833, Acc: 0.9402, AUC: 0.9832, F1: 0.9588
Val   - Loss: 0.3400, Acc: 0.9218, AUC: 0.9843, F1: 0.9484
Early stopping triggered.
Model loaded successfully from ./models/panda/attention/model.pth
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.9982
Accuracy: 0.9493, AUC: 0.9851
Precision: 0.9839, Recall: 0.9453, F1-Score: 0.9642
Confusion Matrix:
[[ 477   20]
 [  71 1226]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
