rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.7246, Acc: 0.6275, AUC: 0.6347, F1: 0.4966
Val   - Loss: 0.6858, Acc: 0.6450, AUC: 0.7621, F1: 0.2680
Final model saved to ./models/rsna/model_attention.pth
Epoch 2/50
Train - Loss: 0.5891, Acc: 0.6737, AUC: 0.7433, F1: 0.5714
Val   - Loss: 0.6483, Acc: 0.6550, AUC: 0.7844, F1: 0.6791
Final model saved to ./models/rsna/model_attention.pth
Epoch 3/50
Train - Loss: 0.5541, Acc: 0.7338, AUC: 0.7900, F1: 0.6548
Val   - Loss: 0.5396, Acc: 0.7000, AUC: 0.7923, F1: 0.6000
Final model saved to ./models/rsna/model_attention.pth
Epoch 4/50
Train - Loss: 0.5404, Acc: 0.7262, AUC: 0.7929, F1: 0.6485
Val   - Loss: 0.5742, Acc: 0.7250, AUC: 0.7947, F1: 0.5926
Final model saved to ./models/rsna/model_attention.pth
Epoch 5/50
Train - Loss: 0.5298, Acc: 0.7500, AUC: 0.8083, F1: 0.6815
Val   - Loss: 0.5208, Acc: 0.7250, AUC: 0.8179, F1: 0.6707
Final model saved to ./models/rsna/model_attention.pth
Epoch 6/50
Train - Loss: 0.5151, Acc: 0.7362, AUC: 0.8226, F1: 0.6708
Val   - Loss: 0.5214, Acc: 0.7350, AUC: 0.8169, F1: 0.6074
Epoch 7/50
Train - Loss: 0.4898, Acc: 0.7725, AUC: 0.8345, F1: 0.7065
Val   - Loss: 0.5381, Acc: 0.7300, AUC: 0.8079, F1: 0.6197
Epoch 8/50
Train - Loss: 0.4849, Acc: 0.7750, AUC: 0.8410, F1: 0.7125
Val   - Loss: 0.5402, Acc: 0.6900, AUC: 0.8111, F1: 0.6437
Epoch 9/50
Train - Loss: 0.5022, Acc: 0.7725, AUC: 0.8339, F1: 0.7102
Val   - Loss: 0.5692, Acc: 0.7050, AUC: 0.8150, F1: 0.5124
Epoch 10/50
Train - Loss: 0.4888, Acc: 0.7700, AUC: 0.8413, F1: 0.7070
Val   - Loss: 0.7096, Acc: 0.6700, AUC: 0.8150, F1: 0.4000
Early stopping triggered.
Model loaded successfully from ./models/rsna/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.1379
Accuracy: 0.8267, AUC: 0.8884
Precision: 0.8108, Recall: 0.8333, F1-Score: 0.8219
Confusion Matrix:
[[64 14]
 [12 60]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
