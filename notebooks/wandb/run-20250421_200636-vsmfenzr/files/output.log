rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.6643, Acc: 0.5950, AUC: 0.6036, F1: 0.3546
Val   - Loss: 0.6216, Acc: 0.7200, AUC: 0.7757, F1: 0.6744
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 2/50
Train - Loss: 0.6264, Acc: 0.6412, AUC: 0.6807, F1: 0.4772
Val   - Loss: 0.5860, Acc: 0.6650, AUC: 0.7934, F1: 0.3619
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 3/50
Train - Loss: 0.5853, Acc: 0.6937, AUC: 0.7407, F1: 0.5923
Val   - Loss: 0.5706, Acc: 0.6650, AUC: 0.8073, F1: 0.3738
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 4/50
Train - Loss: 0.5714, Acc: 0.7250, AUC: 0.7592, F1: 0.6246
Val   - Loss: 0.5369, Acc: 0.7600, AUC: 0.8208, F1: 0.6923
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 5/50
Train - Loss: 0.5481, Acc: 0.7225, AUC: 0.7853, F1: 0.6288
Val   - Loss: 0.5278, Acc: 0.7150, AUC: 0.8275, F1: 0.5778
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 6/50
Train - Loss: 0.5291, Acc: 0.7438, AUC: 0.8051, F1: 0.6600
Val   - Loss: 0.5135, Acc: 0.7800, AUC: 0.8333, F1: 0.7284
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 7/50
Train - Loss: 0.5213, Acc: 0.7438, AUC: 0.8087, F1: 0.6612
Val   - Loss: 0.5210, Acc: 0.7300, AUC: 0.8396, F1: 0.5781
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 8/50
Train - Loss: 0.4980, Acc: 0.7662, AUC: 0.8295, F1: 0.6899
Val   - Loss: 0.4949, Acc: 0.7900, AUC: 0.8444, F1: 0.7375
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 9/50
Train - Loss: 0.4983, Acc: 0.7488, AUC: 0.8281, F1: 0.6753
Val   - Loss: 0.4979, Acc: 0.7950, AUC: 0.8492, F1: 0.7545
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 10/50
Train - Loss: 0.4866, Acc: 0.7725, AUC: 0.8372, F1: 0.7065
Val   - Loss: 0.4865, Acc: 0.8000, AUC: 0.8541, F1: 0.7619
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 11/50
Train - Loss: 0.4791, Acc: 0.7662, AUC: 0.8454, F1: 0.6969
Val   - Loss: 0.4793, Acc: 0.8050, AUC: 0.8559, F1: 0.7578
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 12/50
Train - Loss: 0.4748, Acc: 0.7725, AUC: 0.8490, F1: 0.7083
Val   - Loss: 0.4670, Acc: 0.7850, AUC: 0.8610, F1: 0.7261
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 13/50
Train - Loss: 0.4695, Acc: 0.7837, AUC: 0.8532, F1: 0.7223
Val   - Loss: 0.5020, Acc: 0.7700, AUC: 0.8618, F1: 0.7444
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 14/50
Train - Loss: 0.4705, Acc: 0.7762, AUC: 0.8526, F1: 0.7080
Val   - Loss: 0.4655, Acc: 0.7950, AUC: 0.8633, F1: 0.7421
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 15/50
Train - Loss: 0.4654, Acc: 0.7750, AUC: 0.8523, F1: 0.7097
Val   - Loss: 0.4872, Acc: 0.7750, AUC: 0.8681, F1: 0.6715
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 16/50
Train - Loss: 0.4483, Acc: 0.8013, AUC: 0.8664, F1: 0.7464
Val   - Loss: 0.4809, Acc: 0.7900, AUC: 0.8670, F1: 0.7586
Epoch 17/50
Train - Loss: 0.4481, Acc: 0.7975, AUC: 0.8677, F1: 0.7437
Val   - Loss: 0.5049, Acc: 0.7750, AUC: 0.8683, F1: 0.7594
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 18/50
Train - Loss: 0.4324, Acc: 0.8013, AUC: 0.8794, F1: 0.7440
Val   - Loss: 0.4590, Acc: 0.7900, AUC: 0.8731, F1: 0.7000
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 19/50
Train - Loss: 0.4343, Acc: 0.8013, AUC: 0.8761, F1: 0.7440
Val   - Loss: 0.4822, Acc: 0.7900, AUC: 0.8720, F1: 0.7614
Epoch 20/50
Train - Loss: 0.4335, Acc: 0.8050, AUC: 0.8763, F1: 0.7476
Val   - Loss: 0.4868, Acc: 0.7950, AUC: 0.8730, F1: 0.7709
Epoch 21/50
Train - Loss: 0.4186, Acc: 0.8087, AUC: 0.8859, F1: 0.7528
Val   - Loss: 0.4920, Acc: 0.7900, AUC: 0.8735, F1: 0.7692
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 22/50
Train - Loss: 0.4320, Acc: 0.8113, AUC: 0.8762, F1: 0.7592
Val   - Loss: 0.5051, Acc: 0.7800, AUC: 0.8738, F1: 0.7660
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 23/50
Train - Loss: 0.4285, Acc: 0.8063, AUC: 0.8790, F1: 0.7544
Val   - Loss: 0.4449, Acc: 0.8000, AUC: 0.8803, F1: 0.7500
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 24/50
Train - Loss: 0.4141, Acc: 0.8137, AUC: 0.8881, F1: 0.7601
Val   - Loss: 0.4933, Acc: 0.7700, AUC: 0.8813, F1: 0.6515
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 25/50
Train - Loss: 0.4069, Acc: 0.8350, AUC: 0.8939, F1: 0.7898
Val   - Loss: 0.5549, Acc: 0.7300, AUC: 0.8777, F1: 0.7327
Epoch 26/50
Train - Loss: 0.4121, Acc: 0.8063, AUC: 0.8883, F1: 0.7528
Val   - Loss: 0.4565, Acc: 0.8100, AUC: 0.8837, F1: 0.7286
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 27/50
Train - Loss: 0.4089, Acc: 0.8100, AUC: 0.8932, F1: 0.7587
Val   - Loss: 0.4659, Acc: 0.7950, AUC: 0.8823, F1: 0.7657
Epoch 28/50
Train - Loss: 0.4074, Acc: 0.8163, AUC: 0.8932, F1: 0.7678
Val   - Loss: 0.4872, Acc: 0.7900, AUC: 0.8835, F1: 0.7742
Epoch 29/50
Train - Loss: 0.4049, Acc: 0.8200, AUC: 0.8933, F1: 0.7729
Val   - Loss: 0.4425, Acc: 0.8050, AUC: 0.8794, F1: 0.7451
Epoch 30/50
Train - Loss: 0.4033, Acc: 0.8237, AUC: 0.8937, F1: 0.7780
Val   - Loss: 0.4422, Acc: 0.8200, AUC: 0.8803, F1: 0.7600
Epoch 31/50
Train - Loss: 0.3900, Acc: 0.8213, AUC: 0.9026, F1: 0.7741
Val   - Loss: 0.4821, Acc: 0.7850, AUC: 0.8820, F1: 0.6861
Early stopping triggered.
Model loaded successfully from ./models/rsna/mean/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/mean/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.2574
Accuracy: 0.8600, AUC: 0.9136
Precision: 0.8592, Recall: 0.8472, F1-Score: 0.8531
Confusion Matrix:
[[68 10]
 [11 61]]
