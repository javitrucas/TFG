rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.7723, Acc: 0.5975, AUC: 0.6137, F1: 0.4059
Val   - Loss: 0.8721, Acc: 0.6050, AUC: 0.6780, F1: 0.5031
Final model saved to ./models/rsna/max/model_max.pth
Epoch 2/50
Train - Loss: 0.6635, Acc: 0.6837, AUC: 0.7298, F1: 0.5600
Val   - Loss: 0.6174, Acc: 0.6400, AUC: 0.7373, F1: 0.3793
Final model saved to ./models/rsna/max/model_max.pth
Epoch 3/50
Train - Loss: 0.6346, Acc: 0.7288, AUC: 0.7828, F1: 0.6328
Val   - Loss: 0.6087, Acc: 0.6700, AUC: 0.7675, F1: 0.5976
Final model saved to ./models/rsna/max/model_max.pth
Epoch 4/50
Train - Loss: 0.5407, Acc: 0.7638, AUC: 0.8243, F1: 0.6886
Val   - Loss: 0.5839, Acc: 0.6900, AUC: 0.7858, F1: 0.5441
Final model saved to ./models/rsna/max/model_max.pth
Epoch 5/50
Train - Loss: 0.5264, Acc: 0.7575, AUC: 0.8273, F1: 0.6788
Val   - Loss: 0.5755, Acc: 0.7300, AUC: 0.8137, F1: 0.6707
Final model saved to ./models/rsna/max/model_max.pth
Epoch 6/50
Train - Loss: 0.5209, Acc: 0.7675, AUC: 0.8314, F1: 0.6921
Val   - Loss: 0.5598, Acc: 0.6800, AUC: 0.8257, F1: 0.4839
Final model saved to ./models/rsna/max/model_max.pth
Epoch 7/50
Train - Loss: 0.4883, Acc: 0.7812, AUC: 0.8518, F1: 0.7126
Val   - Loss: 0.5450, Acc: 0.7150, AUC: 0.8378, F1: 0.5778
Final model saved to ./models/rsna/max/model_max.pth
Epoch 8/50
Train - Loss: 0.4697, Acc: 0.7937, AUC: 0.8713, F1: 0.7317
Val   - Loss: 0.5416, Acc: 0.7400, AUC: 0.8343, F1: 0.6389
Epoch 9/50
Train - Loss: 0.4929, Acc: 0.8000, AUC: 0.8688, F1: 0.7444
Val   - Loss: 0.5432, Acc: 0.6850, AUC: 0.8418, F1: 0.4793
Final model saved to ./models/rsna/max/model_max.pth
Epoch 10/50
Train - Loss: 0.4357, Acc: 0.8125, AUC: 0.8921, F1: 0.7573
Val   - Loss: 0.5237, Acc: 0.7350, AUC: 0.8456, F1: 0.6187
Final model saved to ./models/rsna/max/model_max.pth
Epoch 11/50
Train - Loss: 0.4182, Acc: 0.8287, AUC: 0.8991, F1: 0.7856
Val   - Loss: 0.5290, Acc: 0.6950, AUC: 0.8521, F1: 0.5041
Final model saved to ./models/rsna/max/model_max.pth
Epoch 12/50
Train - Loss: 0.4247, Acc: 0.8300, AUC: 0.9042, F1: 0.7799
Val   - Loss: 0.5153, Acc: 0.7800, AUC: 0.8588, F1: 0.7381
Final model saved to ./models/rsna/max/model_max.pth
Epoch 13/50
Train - Loss: 0.3966, Acc: 0.8287, AUC: 0.9101, F1: 0.7808
Val   - Loss: 0.5097, Acc: 0.7150, AUC: 0.8597, F1: 0.5714
Final model saved to ./models/rsna/max/model_max.pth
Epoch 14/50
Train - Loss: 0.3803, Acc: 0.8462, AUC: 0.9201, F1: 0.8045
Val   - Loss: 0.5025, Acc: 0.7250, AUC: 0.8648, F1: 0.5926
Final model saved to ./models/rsna/max/model_max.pth
Epoch 15/50
Train - Loss: 0.3644, Acc: 0.8413, AUC: 0.9197, F1: 0.7968
Val   - Loss: 0.5132, Acc: 0.7700, AUC: 0.8562, F1: 0.7160
Epoch 16/50
Train - Loss: 0.3754, Acc: 0.8462, AUC: 0.9203, F1: 0.8051
Val   - Loss: 0.4888, Acc: 0.7650, AUC: 0.8674, F1: 0.6759
Final model saved to ./models/rsna/max/model_max.pth
Epoch 17/50
Train - Loss: 0.3664, Acc: 0.8550, AUC: 0.9246, F1: 0.8147
Val   - Loss: 0.4838, Acc: 0.7900, AUC: 0.8698, F1: 0.7200
Final model saved to ./models/rsna/max/model_max.pth
Epoch 18/50
Train - Loss: 0.3691, Acc: 0.8662, AUC: 0.9292, F1: 0.8315
Val   - Loss: 0.4863, Acc: 0.7850, AUC: 0.8654, F1: 0.7114
Epoch 19/50
Train - Loss: 0.3429, Acc: 0.8538, AUC: 0.9338, F1: 0.8146
Val   - Loss: 0.4766, Acc: 0.8000, AUC: 0.8729, F1: 0.7333
Final model saved to ./models/rsna/max/model_max.pth
Epoch 20/50
Train - Loss: 0.3620, Acc: 0.8625, AUC: 0.9348, F1: 0.8248
Val   - Loss: 0.4759, Acc: 0.7950, AUC: 0.8720, F1: 0.7285
Epoch 21/50
Train - Loss: 0.3182, Acc: 0.8738, AUC: 0.9407, F1: 0.8399
Val   - Loss: 0.4730, Acc: 0.8000, AUC: 0.8716, F1: 0.7403
Epoch 22/50
Train - Loss: 0.3081, Acc: 0.8825, AUC: 0.9448, F1: 0.8531
Val   - Loss: 0.4931, Acc: 0.7950, AUC: 0.8716, F1: 0.7735
Epoch 23/50
Train - Loss: 0.3019, Acc: 0.8875, AUC: 0.9472, F1: 0.8585
Val   - Loss: 0.4672, Acc: 0.7950, AUC: 0.8746, F1: 0.7285
Final model saved to ./models/rsna/max/model_max.pth
Epoch 24/50
Train - Loss: 0.2905, Acc: 0.8925, AUC: 0.9505, F1: 0.8665
Val   - Loss: 0.4857, Acc: 0.7800, AUC: 0.8641, F1: 0.7412
Epoch 25/50
Train - Loss: 0.2791, Acc: 0.9025, AUC: 0.9556, F1: 0.8766
Val   - Loss: 0.4614, Acc: 0.8050, AUC: 0.8776, F1: 0.7417
Final model saved to ./models/rsna/max/model_max.pth
Epoch 26/50
Train - Loss: 0.2935, Acc: 0.8838, AUC: 0.9542, F1: 0.8554
Val   - Loss: 0.4639, Acc: 0.7900, AUC: 0.8720, F1: 0.7308
Epoch 27/50
Train - Loss: 0.2757, Acc: 0.8988, AUC: 0.9575, F1: 0.8728
Val   - Loss: 0.4738, Acc: 0.7850, AUC: 0.8707, F1: 0.7425
Epoch 28/50
Train - Loss: 0.2842, Acc: 0.8938, AUC: 0.9543, F1: 0.8670
Val   - Loss: 0.4639, Acc: 0.8000, AUC: 0.8775, F1: 0.7647
Epoch 29/50
Train - Loss: 0.2589, Acc: 0.8888, AUC: 0.9631, F1: 0.8624
Val   - Loss: 0.4543, Acc: 0.8050, AUC: 0.8786, F1: 0.7451
Final model saved to ./models/rsna/max/model_max.pth
Epoch 30/50
Train - Loss: 0.2588, Acc: 0.9000, AUC: 0.9626, F1: 0.8750
Val   - Loss: 0.4552, Acc: 0.7900, AUC: 0.8753, F1: 0.7273
Epoch 31/50
Train - Loss: 0.2471, Acc: 0.9062, AUC: 0.9664, F1: 0.8841
Val   - Loss: 0.4655, Acc: 0.7600, AUC: 0.8761, F1: 0.6620
Epoch 32/50
Train - Loss: 0.2334, Acc: 0.9163, AUC: 0.9713, F1: 0.8968
Val   - Loss: 0.4547, Acc: 0.7950, AUC: 0.8748, F1: 0.7453
Epoch 33/50
Train - Loss: 0.2517, Acc: 0.9038, AUC: 0.9632, F1: 0.8806
Val   - Loss: 0.4609, Acc: 0.7650, AUC: 0.8793, F1: 0.6619
Final model saved to ./models/rsna/max/model_max.pth
Epoch 34/50
Train - Loss: 0.2257, Acc: 0.9263, AUC: 0.9753, F1: 0.9085
Val   - Loss: 0.4656, Acc: 0.7600, AUC: 0.8769, F1: 0.6522
Epoch 35/50
Train - Loss: 0.2272, Acc: 0.9213, AUC: 0.9737, F1: 0.9008
Val   - Loss: 0.4540, Acc: 0.8050, AUC: 0.8771, F1: 0.7692
Epoch 36/50
Train - Loss: 0.2224, Acc: 0.9187, AUC: 0.9744, F1: 0.8986
Val   - Loss: 0.4613, Acc: 0.7700, AUC: 0.8731, F1: 0.6761
Epoch 37/50
Train - Loss: 0.2200, Acc: 0.9313, AUC: 0.9743, F1: 0.9145
Val   - Loss: 0.4584, Acc: 0.7750, AUC: 0.8747, F1: 0.6853
Epoch 38/50
Train - Loss: 0.2271, Acc: 0.9263, AUC: 0.9723, F1: 0.9085
Val   - Loss: 0.4500, Acc: 0.7900, AUC: 0.8759, F1: 0.7470
Early stopping triggered.
Model loaded successfully from ./models/rsna/max/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/max/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.4418
Accuracy: 0.8333, AUC: 0.9022
Precision: 0.8133, Recall: 0.8472, F1-Score: 0.8299
Confusion Matrix:
[[64 14]
 [11 61]]
