panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|██████████| 8822/8822 [01:39<00:00, 88.29it/s]
[WSIDataset] Building data dict: 100%|██████████| 1794/1794 [00:18<00:00, 97.39it/s] 
[WSIDataset] Skipped 5 bags
[WSIDataset] Found 8817 already processed bags
panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|█████████▉| 1789/1794 [00:18<00:00, 98.43it/s] 
[WSIDataset] Skipped 0 bags
[WSIDataset] Found 1794 already processed bags
Epoch 1/15
Train - Loss: 0.2169, Acc: 0.9138, AUC: 0.9674, F1: 0.9408
Val   - Loss: 0.1656, Acc: 0.9467, AUC: 0.9832, F1: 0.9629
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 2/15
Train - Loss: 0.1792, Acc: 0.9352, AUC: 0.9788, F1: 0.9554
Val   - Loss: 0.1690, Acc: 0.9348, AUC: 0.9849, F1: 0.9562
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 3/15
Train - Loss: 0.1692, Acc: 0.9346, AUC: 0.9812, F1: 0.9551
Val   - Loss: 0.1903, Acc: 0.9371, AUC: 0.9852, F1: 0.9553
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 4/15
Train - Loss: 0.1729, Acc: 0.9379, AUC: 0.9814, F1: 0.9573
Val   - Loss: 0.1663, Acc: 0.9450, AUC: 0.9827, F1: 0.9625
Epoch 5/15
Train - Loss: 0.1727, Acc: 0.9362, AUC: 0.9822, F1: 0.9561
Val   - Loss: 0.1421, Acc: 0.9507, AUC: 0.9840, F1: 0.9663
Epoch 6/15
Train - Loss: 0.1693, Acc: 0.9407, AUC: 0.9832, F1: 0.9592
Val   - Loss: 0.4589, Acc: 0.8838, AUC: 0.9859, F1: 0.9256
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 7/15
Train - Loss: 0.1823, Acc: 0.9380, AUC: 0.9835, F1: 0.9574
Val   - Loss: 0.2138, Acc: 0.9461, AUC: 0.9832, F1: 0.9633
Epoch 8/15
Train - Loss: 0.1758, Acc: 0.9419, AUC: 0.9843, F1: 0.9600
Val   - Loss: 0.1415, Acc: 0.9456, AUC: 0.9862, F1: 0.9623
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 9/15
Train - Loss: 0.1817, Acc: 0.9416, AUC: 0.9841, F1: 0.9598
Val   - Loss: 0.2159, Acc: 0.9388, AUC: 0.9867, F1: 0.9590
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 10/15
Train - Loss: 0.1717, Acc: 0.9461, AUC: 0.9860, F1: 0.9629
Val   - Loss: 0.1682, Acc: 0.9473, AUC: 0.9857, F1: 0.9641
Epoch 11/15
Train - Loss: 0.1810, Acc: 0.9439, AUC: 0.9839, F1: 0.9614
Val   - Loss: 0.2100, Acc: 0.9490, AUC: 0.9854, F1: 0.9652
Epoch 12/15
Train - Loss: 0.1827, Acc: 0.9443, AUC: 0.9840, F1: 0.9617
Val   - Loss: 0.1869, Acc: 0.9422, AUC: 0.9859, F1: 0.9608
Epoch 13/15
Train - Loss: 0.1859, Acc: 0.9419, AUC: 0.9846, F1: 0.9601
Val   - Loss: 0.2048, Acc: 0.9478, AUC: 0.9870, F1: 0.9648
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 14/15
Train - Loss: 0.1808, Acc: 0.9471, AUC: 0.9843, F1: 0.9637
Val   - Loss: 0.2415, Acc: 0.9354, AUC: 0.9831, F1: 0.9563
Epoch 15/15
Train - Loss: 0.1654, Acc: 0.9497, AUC: 0.9864, F1: 0.9654
Val   - Loss: 0.1783, Acc: 0.9546, AUC: 0.9884, F1: 0.9685
Final model saved to ./models/panda/attention/model_attention.pth
Model loaded successfully from ./models/panda/attention/model.pth
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.8125
Accuracy: 0.9543, AUC: 0.9892
Precision: 0.9895, Recall: 0.9468, F1-Score: 0.9677
Confusion Matrix:
[[ 484   13]
 [  69 1228]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
