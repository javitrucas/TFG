panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|██████████| 8822/8822 [01:19<00:00, 111.20it/s]
[WSIDataset] Building data dict: 100%|██████████| 1794/1794 [00:19<00:00, 90.29it/s]]
[WSIDataset] Skipped 5 bags
[WSIDataset] Found 8817 already processed bags
panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict:  99%|█████████▉| 1782/1794 [00:19<00:00, 88.34it/s] 
[WSIDataset] Skipped 0 bags
[WSIDataset] Found 1794 already processed bags
Epoch 1/15
Train - Loss: 0.2192, Acc: 0.9182, AUC: 0.9673, F1: 0.9437
Val   - Loss: 0.1249, Acc: 0.9484, AUC: 0.9878, F1: 0.9644
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 2/15
Train - Loss: 0.1829, Acc: 0.9324, AUC: 0.9770, F1: 0.9535
Val   - Loss: 0.1740, Acc: 0.9359, AUC: 0.9859, F1: 0.9566
Epoch 3/15
Train - Loss: 0.1830, Acc: 0.9319, AUC: 0.9778, F1: 0.9532
Val   - Loss: 0.1210, Acc: 0.9575, AUC: 0.9895, F1: 0.9704
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 4/15
Train - Loss: 0.1780, Acc: 0.9382, AUC: 0.9801, F1: 0.9575
Val   - Loss: 0.1209, Acc: 0.9439, AUC: 0.9908, F1: 0.9622
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 5/15
Train - Loss: 0.1784, Acc: 0.9409, AUC: 0.9807, F1: 0.9593
Val   - Loss: 0.1479, Acc: 0.9501, AUC: 0.9868, F1: 0.9657
Epoch 6/15
Train - Loss: 0.1701, Acc: 0.9420, AUC: 0.9832, F1: 0.9601
Val   - Loss: 0.1183, Acc: 0.9535, AUC: 0.9894, F1: 0.9678
Epoch 7/15
Train - Loss: 0.1729, Acc: 0.9423, AUC: 0.9824, F1: 0.9603
Val   - Loss: 0.1280, Acc: 0.9592, AUC: 0.9922, F1: 0.9714
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 8/15
Train - Loss: 0.1660, Acc: 0.9444, AUC: 0.9839, F1: 0.9618
Val   - Loss: 0.1145, Acc: 0.9592, AUC: 0.9914, F1: 0.9717
Epoch 9/15
Train - Loss: 0.1808, Acc: 0.9393, AUC: 0.9839, F1: 0.9583
Val   - Loss: 0.1281, Acc: 0.9609, AUC: 0.9906, F1: 0.9729
Epoch 10/15
Train - Loss: 0.1707, Acc: 0.9465, AUC: 0.9837, F1: 0.9633
Val   - Loss: 0.2057, Acc: 0.9541, AUC: 0.9884, F1: 0.9680
Epoch 11/15
Train - Loss: 0.1821, Acc: 0.9433, AUC: 0.9838, F1: 0.9610
Val   - Loss: 0.1331, Acc: 0.9569, AUC: 0.9912, F1: 0.9700
Epoch 12/15
Train - Loss: 0.1729, Acc: 0.9470, AUC: 0.9835, F1: 0.9635
Val   - Loss: 0.3391, Acc: 0.9059, AUC: 0.9896, F1: 0.9390
Early stopping triggered.
Model loaded successfully from ./models/panda/attention/model.pth
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.9998
Accuracy: 0.9443, AUC: 0.9850
Precision: 0.9910, Recall: 0.9314, F1-Score: 0.9603
Confusion Matrix:
[[ 486   11]
 [  89 1208]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
