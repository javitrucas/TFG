rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.7037, Acc: 0.6112, AUC: 0.6194, F1: 0.4534
Val   - Loss: 0.6263, Acc: 0.6650, AUC: 0.7103, F1: 0.4370
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 2/50
Train - Loss: 0.6454, Acc: 0.6412, AUC: 0.6634, F1: 0.5176
Val   - Loss: 0.5893, Acc: 0.6800, AUC: 0.7438, F1: 0.5733
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 3/50
Train - Loss: 0.6058, Acc: 0.6813, AUC: 0.7214, F1: 0.5799
Val   - Loss: 0.6262, Acc: 0.6750, AUC: 0.7758, F1: 0.6597
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 4/50
Train - Loss: 0.5894, Acc: 0.6975, AUC: 0.7428, F1: 0.6033
Val   - Loss: 0.6862, Acc: 0.6000, AUC: 0.7935, F1: 0.6694
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 5/50
Train - Loss: 0.5734, Acc: 0.7238, AUC: 0.7664, F1: 0.6509
Val   - Loss: 0.5237, Acc: 0.7250, AUC: 0.8176, F1: 0.6358
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 6/50
Train - Loss: 0.5608, Acc: 0.7188, AUC: 0.7774, F1: 0.6318
Val   - Loss: 0.5014, Acc: 0.7350, AUC: 0.8272, F1: 0.6624
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 7/50
Train - Loss: 0.5322, Acc: 0.7225, AUC: 0.8008, F1: 0.6498
Val   - Loss: 0.5873, Acc: 0.6700, AUC: 0.8556, F1: 0.3654
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 8/50
Train - Loss: 0.5259, Acc: 0.7488, AUC: 0.8130, F1: 0.6794
Val   - Loss: 0.4931, Acc: 0.7550, AUC: 0.8438, F1: 0.6918
Epoch 9/50
Train - Loss: 0.5208, Acc: 0.7450, AUC: 0.8152, F1: 0.6741
Val   - Loss: 0.4828, Acc: 0.7750, AUC: 0.8583, F1: 0.7059
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 10/50
Train - Loss: 0.5172, Acc: 0.7488, AUC: 0.8231, F1: 0.6804
Val   - Loss: 0.4759, Acc: 0.7600, AUC: 0.8751, F1: 0.6571
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 11/50
Train - Loss: 0.4957, Acc: 0.7700, AUC: 0.8356, F1: 0.7042
Val   - Loss: 0.4397, Acc: 0.8200, AUC: 0.8787, F1: 0.7805
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 12/50
Train - Loss: 0.4906, Acc: 0.7550, AUC: 0.8376, F1: 0.6889
Val   - Loss: 0.5178, Acc: 0.7450, AUC: 0.8829, F1: 0.7463
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 13/50
Train - Loss: 0.5007, Acc: 0.7638, AUC: 0.8316, F1: 0.7005
Val   - Loss: 0.5154, Acc: 0.7200, AUC: 0.8861, F1: 0.5254
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 14/50
Train - Loss: 0.4942, Acc: 0.7762, AUC: 0.8365, F1: 0.7154
Val   - Loss: 0.5887, Acc: 0.7250, AUC: 0.8766, F1: 0.7418
Epoch 15/50
Train - Loss: 0.4733, Acc: 0.7875, AUC: 0.8531, F1: 0.7276
Val   - Loss: 0.4388, Acc: 0.8250, AUC: 0.8875, F1: 0.7953
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 16/50
Train - Loss: 0.4998, Acc: 0.7475, AUC: 0.8333, F1: 0.6814
Val   - Loss: 0.4327, Acc: 0.7700, AUC: 0.8898, F1: 0.6761
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 17/50
Train - Loss: 0.4888, Acc: 0.7913, AUC: 0.8428, F1: 0.7353
Val   - Loss: 0.5277, Acc: 0.7250, AUC: 0.8915, F1: 0.5600
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 18/50
Train - Loss: 0.4575, Acc: 0.7913, AUC: 0.8617, F1: 0.7337
Val   - Loss: 0.4264, Acc: 0.8300, AUC: 0.8908, F1: 0.7952
Epoch 19/50
Train - Loss: 0.4546, Acc: 0.7863, AUC: 0.8605, F1: 0.7299
Val   - Loss: 0.4207, Acc: 0.7950, AUC: 0.8965, F1: 0.7172
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 20/50
Train - Loss: 0.4523, Acc: 0.7937, AUC: 0.8679, F1: 0.7360
Val   - Loss: 0.4836, Acc: 0.7350, AUC: 0.8947, F1: 0.5827
Epoch 21/50
Train - Loss: 0.4455, Acc: 0.7937, AUC: 0.8674, F1: 0.7402
Val   - Loss: 0.8836, Acc: 0.5700, AUC: 0.8954, F1: 0.6560
Epoch 22/50
Train - Loss: 0.4653, Acc: 0.8000, AUC: 0.8638, F1: 0.7484
Val   - Loss: 0.4068, Acc: 0.8400, AUC: 0.8988, F1: 0.7949
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 23/50
Train - Loss: 0.4564, Acc: 0.7837, AUC: 0.8634, F1: 0.7267
Val   - Loss: 0.5505, Acc: 0.7250, AUC: 0.8982, F1: 0.5378
Epoch 24/50
Train - Loss: 0.4396, Acc: 0.7900, AUC: 0.8716, F1: 0.7383
Val   - Loss: 0.4648, Acc: 0.8000, AUC: 0.8908, F1: 0.7802
Epoch 25/50
Train - Loss: 0.4585, Acc: 0.8000, AUC: 0.8625, F1: 0.7468
Val   - Loss: 0.4108, Acc: 0.8050, AUC: 0.8968, F1: 0.7417
Epoch 26/50
Train - Loss: 0.4414, Acc: 0.8100, AUC: 0.8739, F1: 0.7548
Val   - Loss: 0.4314, Acc: 0.8300, AUC: 0.8999, F1: 0.8068
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 27/50
Train - Loss: 0.4470, Acc: 0.8000, AUC: 0.8694, F1: 0.7500
Val   - Loss: 0.4406, Acc: 0.8300, AUC: 0.8894, F1: 0.8046
Epoch 28/50
Train - Loss: 0.4305, Acc: 0.8037, AUC: 0.8823, F1: 0.7480
Val   - Loss: 0.4248, Acc: 0.8350, AUC: 0.8945, F1: 0.8092
Epoch 29/50
Train - Loss: 0.4385, Acc: 0.8150, AUC: 0.8747, F1: 0.7680
Val   - Loss: 0.4104, Acc: 0.8150, AUC: 0.8980, F1: 0.7582
Epoch 30/50
Train - Loss: 0.4436, Acc: 0.7937, AUC: 0.8722, F1: 0.7442
Val   - Loss: 0.4365, Acc: 0.8350, AUC: 0.8926, F1: 0.8092
Epoch 31/50
Train - Loss: 0.4380, Acc: 0.7937, AUC: 0.8753, F1: 0.7360
Val   - Loss: 0.4125, Acc: 0.8300, AUC: 0.8978, F1: 0.7952
Early stopping triggered.
Model loaded successfully from ./models/rsna/mean/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/mean/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.6212
Accuracy: 0.8200, AUC: 0.9060
Precision: 0.8814, Recall: 0.7222, F1-Score: 0.7939
Confusion Matrix:
[[71  7]
 [20 52]]
