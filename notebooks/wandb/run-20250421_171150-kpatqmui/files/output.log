rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.7129, Acc: 0.6150, AUC: 0.5921, F1: 0.4815
Val   - Loss: 0.5904, Acc: 0.6500, AUC: 0.7667, F1: 0.3636
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 2/50
Train - Loss: 0.6058, Acc: 0.6825, AUC: 0.7246, F1: 0.5822
Val   - Loss: 0.5674, Acc: 0.6750, AUC: 0.7723, F1: 0.5390
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 3/50
Train - Loss: 0.5611, Acc: 0.7212, AUC: 0.7772, F1: 0.6466
Val   - Loss: 0.5481, Acc: 0.7100, AUC: 0.7937, F1: 0.6548
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 4/50
Train - Loss: 0.5601, Acc: 0.7113, AUC: 0.7768, F1: 0.6131
Val   - Loss: 0.5311, Acc: 0.7200, AUC: 0.8090, F1: 0.6111
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 5/50
Train - Loss: 0.5389, Acc: 0.7362, AUC: 0.8051, F1: 0.6645
Val   - Loss: 0.5288, Acc: 0.7100, AUC: 0.8136, F1: 0.6081
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 6/50
Train - Loss: 0.5360, Acc: 0.7388, AUC: 0.7999, F1: 0.6613
Val   - Loss: 0.5765, Acc: 0.7250, AUC: 0.8014, F1: 0.6784
Epoch 7/50
Train - Loss: 0.5087, Acc: 0.7475, AUC: 0.8221, F1: 0.6763
Val   - Loss: 0.5035, Acc: 0.7450, AUC: 0.8271, F1: 0.6792
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 8/50
Train - Loss: 0.5099, Acc: 0.7612, AUC: 0.8245, F1: 0.6973
Val   - Loss: 0.5014, Acc: 0.7400, AUC: 0.8294, F1: 0.6667
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 9/50
Train - Loss: 0.5040, Acc: 0.7712, AUC: 0.8266, F1: 0.7163
Val   - Loss: 0.5341, Acc: 0.7200, AUC: 0.8470, F1: 0.5556
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 10/50
Train - Loss: 0.4829, Acc: 0.7675, AUC: 0.8432, F1: 0.7029
Val   - Loss: 0.5691, Acc: 0.7500, AUC: 0.8305, F1: 0.7024
Epoch 11/50
Train - Loss: 0.4715, Acc: 0.7650, AUC: 0.8557, F1: 0.7081
Val   - Loss: 0.4870, Acc: 0.7450, AUC: 0.8449, F1: 0.6667
Epoch 12/50
Train - Loss: 0.4970, Acc: 0.7600, AUC: 0.8359, F1: 0.6952
Val   - Loss: 0.4933, Acc: 0.7600, AUC: 0.8447, F1: 0.6883
Epoch 13/50
Train - Loss: 0.4503, Acc: 0.8000, AUC: 0.8646, F1: 0.7484
Val   - Loss: 0.4851, Acc: 0.7550, AUC: 0.8548, F1: 0.6573
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 14/50
Train - Loss: 0.4715, Acc: 0.7762, AUC: 0.8534, F1: 0.7181
Val   - Loss: 0.5774, Acc: 0.7500, AUC: 0.8562, F1: 0.7500
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 15/50
Train - Loss: 0.4568, Acc: 0.7925, AUC: 0.8633, F1: 0.7365
Val   - Loss: 0.4843, Acc: 0.7600, AUC: 0.8587, F1: 0.7143
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 16/50
Train - Loss: 0.4409, Acc: 0.8075, AUC: 0.8710, F1: 0.7594
Val   - Loss: 0.5105, Acc: 0.7900, AUC: 0.8593, F1: 0.7640
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 17/50
Train - Loss: 0.4642, Acc: 0.7762, AUC: 0.8607, F1: 0.7207
Val   - Loss: 0.5418, Acc: 0.7650, AUC: 0.8595, F1: 0.7565
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 18/50
Train - Loss: 0.4443, Acc: 0.7925, AUC: 0.8721, F1: 0.7357
Val   - Loss: 0.4857, Acc: 0.7950, AUC: 0.8693, F1: 0.7709
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 19/50
Train - Loss: 0.4287, Acc: 0.8100, AUC: 0.8761, F1: 0.7572
Val   - Loss: 0.4708, Acc: 0.7800, AUC: 0.8695, F1: 0.7105
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 20/50
Train - Loss: 0.4187, Acc: 0.7887, AUC: 0.8836, F1: 0.7305
Val   - Loss: 0.5579, Acc: 0.7600, AUC: 0.8552, F1: 0.6364
Epoch 21/50
Train - Loss: 0.4323, Acc: 0.8050, AUC: 0.8814, F1: 0.7562
Val   - Loss: 0.5342, Acc: 0.7950, AUC: 0.8763, F1: 0.7807
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 22/50
Train - Loss: 0.4041, Acc: 0.8150, AUC: 0.8936, F1: 0.7666
Val   - Loss: 0.5582, Acc: 0.7500, AUC: 0.8692, F1: 0.6212
Epoch 23/50
Train - Loss: 0.3813, Acc: 0.8200, AUC: 0.9040, F1: 0.7757
Val   - Loss: 0.4842, Acc: 0.7900, AUC: 0.8675, F1: 0.7407
Epoch 24/50
Train - Loss: 0.3998, Acc: 0.8275, AUC: 0.8961, F1: 0.7837
Val   - Loss: 0.5170, Acc: 0.7750, AUC: 0.8726, F1: 0.6763
Epoch 25/50
Train - Loss: 0.3968, Acc: 0.8337, AUC: 0.8993, F1: 0.7919
Val   - Loss: 0.5679, Acc: 0.7400, AUC: 0.8429, F1: 0.6176
Epoch 26/50
Train - Loss: 0.4180, Acc: 0.8163, AUC: 0.8883, F1: 0.7670
Val   - Loss: 0.5556, Acc: 0.7250, AUC: 0.8678, F1: 0.5669
Early stopping triggered.
Model loaded successfully from ./models/rsna/attention/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.2217
Accuracy: 0.8000, AUC: 0.8641
Precision: 0.8281, Recall: 0.7361, F1-Score: 0.7794
Confusion Matrix:
[[67 11]
 [19 53]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
