panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|██████████| 8822/8822 [01:44<00:00, 84.69it/s]
[WSIDataset] Building data dict: 100%|██████████| 1794/1794 [00:17<00:00, 104.92it/s]
[WSIDataset] Skipped 5 bags
[WSIDataset] Found 8817 already processed bags
panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|█████████▉| 1791/1794 [00:17<00:00, 100.00it/s]
[WSIDataset] Skipped 0 bags
[WSIDataset] Found 1794 already processed bags
Epoch 1/15
Train - Loss: 0.3473, Acc: 0.8354, AUC: 0.9029, F1: 0.8877
Val   - Loss: 0.2911, Acc: 0.8475, AUC: 0.9423, F1: 0.9011
Final model saved to ./models/panda/mean/model_mean.pth
Epoch 2/15
Train - Loss: 0.2938, Acc: 0.8633, AUC: 0.9321, F1: 0.9061
Val   - Loss: 0.2468, Acc: 0.8861, AUC: 0.9505, F1: 0.9216
Final model saved to ./models/panda/mean/model_mean.pth
Epoch 3/15
Train - Loss: 0.2820, Acc: 0.8711, AUC: 0.9379, F1: 0.9113
Val   - Loss: 0.2824, Acc: 0.8713, AUC: 0.9522, F1: 0.9050
Final model saved to ./models/panda/mean/model_mean.pth
Epoch 4/15
Train - Loss: 0.2705, Acc: 0.8795, AUC: 0.9433, F1: 0.9171
Val   - Loss: 0.2340, Acc: 0.8957, AUC: 0.9559, F1: 0.9264
Final model saved to ./models/panda/mean/model_mean.pth
Epoch 5/15
Train - Loss: 0.2613, Acc: 0.8801, AUC: 0.9473, F1: 0.9174
Val   - Loss: 0.2278, Acc: 0.8980, AUC: 0.9599, F1: 0.9279
Final model saved to ./models/panda/mean/model_mean.pth
Epoch 6/15
Train - Loss: 0.2559, Acc: 0.8844, AUC: 0.9503, F1: 0.9202
Val   - Loss: 0.2539, Acc: 0.8787, AUC: 0.9571, F1: 0.9121
Epoch 7/15
Train - Loss: 0.2515, Acc: 0.8877, AUC: 0.9517, F1: 0.9223
Val   - Loss: 0.2246, Acc: 0.9002, AUC: 0.9612, F1: 0.9291
Final model saved to ./models/panda/mean/model_mean.pth
Epoch 8/15
Train - Loss: 0.2491, Acc: 0.8911, AUC: 0.9533, F1: 0.9249
Val   - Loss: 0.2184, Acc: 0.9008, AUC: 0.9609, F1: 0.9314
Epoch 9/15
Train - Loss: 0.2479, Acc: 0.8898, AUC: 0.9534, F1: 0.9240
Val   - Loss: 0.2297, Acc: 0.8985, AUC: 0.9593, F1: 0.9309
Epoch 10/15
Train - Loss: 0.2413, Acc: 0.8922, AUC: 0.9565, F1: 0.9258
Val   - Loss: 0.2352, Acc: 0.8929, AUC: 0.9610, F1: 0.9281
Epoch 11/15
Train - Loss: 0.2424, Acc: 0.8925, AUC: 0.9557, F1: 0.9259
Val   - Loss: 0.2247, Acc: 0.8957, AUC: 0.9612, F1: 0.9260
Final model saved to ./models/panda/mean/model_mean.pth
Epoch 12/15
Train - Loss: 0.2396, Acc: 0.8975, AUC: 0.9567, F1: 0.9290
Val   - Loss: 0.2220, Acc: 0.8974, AUC: 0.9640, F1: 0.9310
Final model saved to ./models/panda/mean/model_mean.pth
Epoch 13/15
Train - Loss: 0.2338, Acc: 0.8993, AUC: 0.9592, F1: 0.9305
Val   - Loss: 0.2269, Acc: 0.8991, AUC: 0.9615, F1: 0.9320
Epoch 14/15
Train - Loss: 0.2334, Acc: 0.8975, AUC: 0.9592, F1: 0.9292
Val   - Loss: 0.2708, Acc: 0.8543, AUC: 0.9576, F1: 0.9064
Epoch 15/15
Train - Loss: 0.2291, Acc: 0.8995, AUC: 0.9606, F1: 0.9306
Val   - Loss: 0.2354, Acc: 0.8951, AUC: 0.9636, F1: 0.9241
Model loaded successfully from ./models/panda/mean/model.pth
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/mean/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.5314
Accuracy: 0.8857, AUC: 0.9593
Precision: 0.9667, Recall: 0.8720, F1-Score: 0.9169
Confusion Matrix:
[[ 458   39]
 [ 166 1131]]
