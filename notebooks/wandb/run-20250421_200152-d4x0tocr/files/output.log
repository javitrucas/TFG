rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.6628, Acc: 0.5962, AUC: 0.6008, F1: 0.3985
Val   - Loss: 0.6090, Acc: 0.6650, AUC: 0.7605, F1: 0.3619
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 2/50
Train - Loss: 0.6229, Acc: 0.6550, AUC: 0.6899, F1: 0.5106
Val   - Loss: 0.5939, Acc: 0.7100, AUC: 0.7816, F1: 0.6778
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 3/50
Train - Loss: 0.5817, Acc: 0.7212, AUC: 0.7557, F1: 0.6039
Val   - Loss: 0.5690, Acc: 0.7300, AUC: 0.7880, F1: 0.6897
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 4/50
Train - Loss: 0.5666, Acc: 0.7238, AUC: 0.7701, F1: 0.6286
Val   - Loss: 0.5466, Acc: 0.6850, AUC: 0.8016, F1: 0.5532
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 5/50
Train - Loss: 0.5386, Acc: 0.7450, AUC: 0.8006, F1: 0.6507
Val   - Loss: 0.5642, Acc: 0.6850, AUC: 0.8058, F1: 0.4615
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 6/50
Train - Loss: 0.5229, Acc: 0.7562, AUC: 0.8146, F1: 0.6745
Val   - Loss: 0.5313, Acc: 0.7350, AUC: 0.8082, F1: 0.6667
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 7/50
Train - Loss: 0.5037, Acc: 0.7512, AUC: 0.8283, F1: 0.6775
Val   - Loss: 0.5490, Acc: 0.7150, AUC: 0.8092, F1: 0.6816
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 8/50
Train - Loss: 0.4905, Acc: 0.7588, AUC: 0.8359, F1: 0.6872
Val   - Loss: 0.5886, Acc: 0.6800, AUC: 0.8172, F1: 0.4386
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 9/50
Train - Loss: 0.4711, Acc: 0.7812, AUC: 0.8544, F1: 0.7117
Val   - Loss: 0.5176, Acc: 0.7300, AUC: 0.8189, F1: 0.6143
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 10/50
Train - Loss: 0.4707, Acc: 0.7925, AUC: 0.8515, F1: 0.7288
Val   - Loss: 0.5750, Acc: 0.7150, AUC: 0.8166, F1: 0.7136
Epoch 11/50
Train - Loss: 0.4615, Acc: 0.7700, AUC: 0.8573, F1: 0.7003
Val   - Loss: 0.5477, Acc: 0.7150, AUC: 0.8176, F1: 0.6919
Epoch 12/50
Train - Loss: 0.4574, Acc: 0.7875, AUC: 0.8600, F1: 0.7258
Val   - Loss: 0.5183, Acc: 0.7300, AUC: 0.8213, F1: 0.6625
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 13/50
Train - Loss: 0.4456, Acc: 0.7975, AUC: 0.8716, F1: 0.7370
Val   - Loss: 0.5201, Acc: 0.7450, AUC: 0.8223, F1: 0.6331
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 14/50
Train - Loss: 0.4410, Acc: 0.7900, AUC: 0.8681, F1: 0.7316
Val   - Loss: 0.5454, Acc: 0.7200, AUC: 0.8226, F1: 0.5625
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 15/50
Train - Loss: 0.4311, Acc: 0.8013, AUC: 0.8776, F1: 0.7398
Val   - Loss: 0.5179, Acc: 0.7400, AUC: 0.8209, F1: 0.6486
Epoch 16/50
Train - Loss: 0.4215, Acc: 0.8125, AUC: 0.8853, F1: 0.7588
Val   - Loss: 0.5292, Acc: 0.7300, AUC: 0.8208, F1: 0.6786
Epoch 17/50
Train - Loss: 0.4192, Acc: 0.8175, AUC: 0.8851, F1: 0.7660
Val   - Loss: 0.5218, Acc: 0.7450, AUC: 0.8234, F1: 0.6752
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 18/50
Train - Loss: 0.4303, Acc: 0.8087, AUC: 0.8782, F1: 0.7544
Val   - Loss: 0.5771, Acc: 0.7100, AUC: 0.8192, F1: 0.5323
Epoch 19/50
Train - Loss: 0.4137, Acc: 0.8113, AUC: 0.8890, F1: 0.7576
Val   - Loss: 0.5341, Acc: 0.7350, AUC: 0.8234, F1: 0.6864
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 20/50
Train - Loss: 0.4140, Acc: 0.8175, AUC: 0.8860, F1: 0.7704
Val   - Loss: 0.5262, Acc: 0.7400, AUC: 0.8229, F1: 0.6750
Epoch 21/50
Train - Loss: 0.4099, Acc: 0.8187, AUC: 0.8899, F1: 0.7673
Val   - Loss: 0.5412, Acc: 0.7350, AUC: 0.8218, F1: 0.6936
Epoch 22/50
Train - Loss: 0.4155, Acc: 0.8113, AUC: 0.8858, F1: 0.7607
Val   - Loss: 0.5219, Acc: 0.7400, AUC: 0.8250, F1: 0.6579
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 23/50
Train - Loss: 0.3940, Acc: 0.8263, AUC: 0.9018, F1: 0.7790
Val   - Loss: 0.6077, Acc: 0.7100, AUC: 0.8227, F1: 0.7100
Epoch 24/50
Train - Loss: 0.4066, Acc: 0.8250, AUC: 0.8915, F1: 0.7764
Val   - Loss: 0.5352, Acc: 0.7550, AUC: 0.8253, F1: 0.7101
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 25/50
Train - Loss: 0.3986, Acc: 0.8275, AUC: 0.8961, F1: 0.7788
Val   - Loss: 0.7009, Acc: 0.6750, AUC: 0.8262, F1: 0.6977
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 26/50
Train - Loss: 0.4057, Acc: 0.8163, AUC: 0.8934, F1: 0.7678
Val   - Loss: 0.5977, Acc: 0.7200, AUC: 0.8267, F1: 0.7143
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 27/50
Train - Loss: 0.3866, Acc: 0.8263, AUC: 0.9026, F1: 0.7811
Val   - Loss: 0.5466, Acc: 0.7350, AUC: 0.8293, F1: 0.6971
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 28/50
Train - Loss: 0.3874, Acc: 0.8287, AUC: 0.9041, F1: 0.7808
Val   - Loss: 0.6357, Acc: 0.7200, AUC: 0.8264, F1: 0.7228
Epoch 29/50
Train - Loss: 0.3964, Acc: 0.8313, AUC: 0.8978, F1: 0.7861
Val   - Loss: 0.6577, Acc: 0.7050, AUC: 0.8264, F1: 0.4957
Epoch 30/50
Train - Loss: 0.3807, Acc: 0.8387, AUC: 0.9064, F1: 0.7916
Val   - Loss: 0.5330, Acc: 0.7450, AUC: 0.8260, F1: 0.6623
Epoch 31/50
Train - Loss: 0.3927, Acc: 0.8087, AUC: 0.8991, F1: 0.7598
Val   - Loss: 0.6336, Acc: 0.7150, AUC: 0.8242, F1: 0.5210
Epoch 32/50
Train - Loss: 0.3765, Acc: 0.8350, AUC: 0.9089, F1: 0.7898
Val   - Loss: 0.5383, Acc: 0.7550, AUC: 0.8252, F1: 0.6994
Early stopping triggered.
Model loaded successfully from ./models/rsna/mean/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/mean/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.4837
Accuracy: 0.8467, AUC: 0.9181
Precision: 0.8182, Recall: 0.8750, F1-Score: 0.8456
Confusion Matrix:
[[64 14]
 [ 9 63]]
