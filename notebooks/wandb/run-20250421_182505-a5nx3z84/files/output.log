rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.6622, Acc: 0.5887, AUC: 0.6052, F1: 0.3327
Val   - Loss: 0.6024, Acc: 0.6750, AUC: 0.7573, F1: 0.5255
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 2/50
Train - Loss: 0.5827, Acc: 0.7013, AUC: 0.7492, F1: 0.5928
Val   - Loss: 0.6455, Acc: 0.6350, AUC: 0.7801, F1: 0.2316
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 3/50
Train - Loss: 0.5439, Acc: 0.7238, AUC: 0.7874, F1: 0.6286
Val   - Loss: 0.5523, Acc: 0.7200, AUC: 0.7942, F1: 0.6500
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 4/50
Train - Loss: 0.5228, Acc: 0.7325, AUC: 0.8066, F1: 0.6480
Val   - Loss: 0.6173, Acc: 0.6950, AUC: 0.8034, F1: 0.7081
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 5/50
Train - Loss: 0.4868, Acc: 0.7650, AUC: 0.8359, F1: 0.6898
Val   - Loss: 0.5571, Acc: 0.7150, AUC: 0.8031, F1: 0.5440
Epoch 6/50
Train - Loss: 0.4827, Acc: 0.7575, AUC: 0.8401, F1: 0.6881
Val   - Loss: 0.5560, Acc: 0.7150, AUC: 0.8107, F1: 0.6885
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 7/50
Train - Loss: 0.4642, Acc: 0.7788, AUC: 0.8551, F1: 0.7168
Val   - Loss: 0.5303, Acc: 0.7500, AUC: 0.8122, F1: 0.6875
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 8/50
Train - Loss: 0.4481, Acc: 0.7850, AUC: 0.8654, F1: 0.7270
Val   - Loss: 0.5407, Acc: 0.7600, AUC: 0.8152, F1: 0.6471
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 9/50
Train - Loss: 0.4546, Acc: 0.7900, AUC: 0.8620, F1: 0.7325
Val   - Loss: 0.5668, Acc: 0.7150, AUC: 0.8237, F1: 0.7016
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 10/50
Train - Loss: 0.4477, Acc: 0.8087, AUC: 0.8656, F1: 0.7536
Val   - Loss: 0.5377, Acc: 0.7150, AUC: 0.8240, F1: 0.6851
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 11/50
Train - Loss: 0.4285, Acc: 0.8050, AUC: 0.8789, F1: 0.7547
Val   - Loss: 0.5201, Acc: 0.7450, AUC: 0.8243, F1: 0.6752
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 12/50
Train - Loss: 0.4112, Acc: 0.8200, AUC: 0.8911, F1: 0.7743
Val   - Loss: 0.5376, Acc: 0.7500, AUC: 0.8153, F1: 0.6753
Epoch 13/50
Train - Loss: 0.4027, Acc: 0.8150, AUC: 0.8950, F1: 0.7628
Val   - Loss: 0.5424, Acc: 0.7800, AUC: 0.8186, F1: 0.7027
Epoch 14/50
Train - Loss: 0.3968, Acc: 0.8200, AUC: 0.8972, F1: 0.7707
Val   - Loss: 0.5474, Acc: 0.7700, AUC: 0.8257, F1: 0.6618
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 15/50
Train - Loss: 0.3866, Acc: 0.8213, AUC: 0.9026, F1: 0.7705
Val   - Loss: 0.5209, Acc: 0.7650, AUC: 0.8317, F1: 0.6968
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 16/50
Train - Loss: 0.3774, Acc: 0.8275, AUC: 0.9080, F1: 0.7830
Val   - Loss: 0.5471, Acc: 0.7650, AUC: 0.8156, F1: 0.6887
Epoch 17/50
Train - Loss: 0.3773, Acc: 0.8438, AUC: 0.9070, F1: 0.8031
Val   - Loss: 0.5909, Acc: 0.7500, AUC: 0.8109, F1: 0.6212
Epoch 18/50
Train - Loss: 0.3664, Acc: 0.8562, AUC: 0.9150, F1: 0.8183
Val   - Loss: 0.6186, Acc: 0.7350, AUC: 0.8126, F1: 0.5827
Epoch 19/50
Train - Loss: 0.3587, Acc: 0.8550, AUC: 0.9182, F1: 0.8159
Val   - Loss: 0.5871, Acc: 0.7500, AUC: 0.8151, F1: 0.6269
Epoch 20/50
Train - Loss: 0.3679, Acc: 0.8425, AUC: 0.9098, F1: 0.8031
Val   - Loss: 0.5313, Acc: 0.7700, AUC: 0.8408, F1: 0.7160
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 21/50
Train - Loss: 0.3482, Acc: 0.8425, AUC: 0.9221, F1: 0.8025
Val   - Loss: 0.5445, Acc: 0.7850, AUC: 0.8412, F1: 0.6950
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 22/50
Train - Loss: 0.3420, Acc: 0.8675, AUC: 0.9257, F1: 0.8312
Val   - Loss: 0.5454, Acc: 0.7950, AUC: 0.8381, F1: 0.7320
Epoch 23/50
Train - Loss: 0.3481, Acc: 0.8588, AUC: 0.9240, F1: 0.8243
Val   - Loss: 0.5619, Acc: 0.7750, AUC: 0.8563, F1: 0.7541
Final model saved to ./models/rsna/attention/model_attention.pth
Epoch 24/50
Train - Loss: 0.3655, Acc: 0.8375, AUC: 0.9146, F1: 0.7937
Val   - Loss: 0.5429, Acc: 0.7650, AUC: 0.8485, F1: 0.7345
Epoch 25/50
Train - Loss: 0.3378, Acc: 0.8525, AUC: 0.9256, F1: 0.8133
Val   - Loss: 0.5254, Acc: 0.7850, AUC: 0.8520, F1: 0.7075
Epoch 26/50
Train - Loss: 0.3441, Acc: 0.8500, AUC: 0.9219, F1: 0.8101
Val   - Loss: 0.5414, Acc: 0.7700, AUC: 0.8436, F1: 0.6806
Epoch 27/50
Train - Loss: 0.3385, Acc: 0.8650, AUC: 0.9253, F1: 0.8318
Val   - Loss: 0.5506, Acc: 0.7850, AUC: 0.8440, F1: 0.7075
Epoch 28/50
Train - Loss: 0.3247, Acc: 0.8675, AUC: 0.9307, F1: 0.8349
Val   - Loss: 0.5399, Acc: 0.8050, AUC: 0.8484, F1: 0.7547
Early stopping triggered.
Model loaded successfully from ./models/rsna/attention/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.4570
Accuracy: 0.7933, AUC: 0.8811
Precision: 0.7971, Recall: 0.7639, F1-Score: 0.7801
Confusion Matrix:
[[64 14]
 [17 55]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
