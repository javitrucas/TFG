panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|██████████| 8822/8822 [01:45<00:00, 83.81it/s]
[WSIDataset] Building data dict: 100%|██████████| 1794/1794 [00:18<00:00, 99.10it/s] 
[WSIDataset] Skipped 5 bags
[WSIDataset] Found 8817 already processed bags
panda
[WSIDataset] Scanning files...
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
[WSIDataset] Skipped 0 bags
[WSIDataset] Found 1794 already processed bags
Epoch 1/15
Train - Loss: 0.2701, Acc: 0.9083, AUC: 0.9619, F1: 0.9372
Val   - Loss: 0.1968, Acc: 0.9388, AUC: 0.9809, F1: 0.9575
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 2/15
Train - Loss: 0.2206, Acc: 0.9284, AUC: 0.9761, F1: 0.9508
Val   - Loss: 0.2908, Acc: 0.9393, AUC: 0.9833, F1: 0.9572
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 3/15
Train - Loss: 0.2572, Acc: 0.9278, AUC: 0.9749, F1: 0.9505
Val   - Loss: 0.4324, Acc: 0.8866, AUC: 0.9774, F1: 0.9159
Epoch 4/15
Train - Loss: 0.2437, Acc: 0.9331, AUC: 0.9777, F1: 0.9540
Val   - Loss: 0.4672, Acc: 0.8770, AUC: 0.9812, F1: 0.9215
Epoch 5/15
Train - Loss: 0.2574, Acc: 0.9342, AUC: 0.9767, F1: 0.9548
Val   - Loss: 0.4953, Acc: 0.9087, AUC: 0.9814, F1: 0.9334
Epoch 6/15
Train - Loss: 0.2693, Acc: 0.9344, AUC: 0.9765, F1: 0.9549
Val   - Loss: 0.4221, Acc: 0.9314, AUC: 0.9738, F1: 0.9514
Epoch 7/15
Train - Loss: 0.2464, Acc: 0.9417, AUC: 0.9809, F1: 0.9600
Val   - Loss: 0.4101, Acc: 0.9331, AUC: 0.9769, F1: 0.9545
Early stopping triggered.
Model loaded successfully from ./models/panda/attention/model.pth
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.9995
Accuracy: 0.9476, AUC: 0.9819
Precision: 0.9878, Recall: 0.9391, F1-Score: 0.9628
Confusion Matrix:
[[ 482   15]
 [  79 1218]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
