rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.6999, Acc: 0.6425, AUC: 0.6453, F1: 0.4982
Val   - Loss: 0.7262, Acc: 0.6350, AUC: 0.7089, F1: 0.5576
Final model saved to ./models/rsna/max/model_max.pth
Epoch 2/50
Train - Loss: 0.6498, Acc: 0.6975, AUC: 0.7633, F1: 0.6097
Val   - Loss: 0.5995, Acc: 0.6650, AUC: 0.7579, F1: 0.4640
Final model saved to ./models/rsna/max/model_max.pth
Epoch 3/50
Train - Loss: 0.5406, Acc: 0.7538, AUC: 0.8164, F1: 0.6765
Val   - Loss: 0.6828, Acc: 0.6950, AUC: 0.7826, F1: 0.6703
Final model saved to ./models/rsna/max/model_max.pth
Epoch 4/50
Train - Loss: 0.5412, Acc: 0.7662, AUC: 0.8422, F1: 0.6939
Val   - Loss: 0.6096, Acc: 0.7250, AUC: 0.8045, F1: 0.6309
Final model saved to ./models/rsna/max/model_max.pth
Epoch 5/50
Train - Loss: 0.5107, Acc: 0.7775, AUC: 0.8524, F1: 0.7033
Val   - Loss: 0.5896, Acc: 0.7200, AUC: 0.8272, F1: 0.7228
Final model saved to ./models/rsna/max/model_max.pth
Epoch 6/50
Train - Loss: 0.5102, Acc: 0.7913, AUC: 0.8697, F1: 0.7328
Val   - Loss: 0.5325, Acc: 0.7500, AUC: 0.8439, F1: 0.6667
Final model saved to ./models/rsna/max/model_max.pth
Epoch 7/50
Train - Loss: 0.5012, Acc: 0.8187, AUC: 0.8776, F1: 0.7650
Val   - Loss: 0.5340, Acc: 0.7750, AUC: 0.8458, F1: 0.7273
Final model saved to ./models/rsna/max/model_max.pth
Epoch 8/50
Train - Loss: 0.4934, Acc: 0.8363, AUC: 0.8927, F1: 0.7937
Val   - Loss: 0.5187, Acc: 0.7200, AUC: 0.8487, F1: 0.6056
Final model saved to ./models/rsna/max/model_max.pth
Epoch 9/50
Train - Loss: 0.4265, Acc: 0.8187, AUC: 0.8916, F1: 0.7658
Val   - Loss: 0.5117, Acc: 0.7250, AUC: 0.8602, F1: 0.5865
Final model saved to ./models/rsna/max/model_max.pth
Epoch 10/50
Train - Loss: 0.4362, Acc: 0.8287, AUC: 0.8978, F1: 0.7856
Val   - Loss: 0.5373, Acc: 0.7200, AUC: 0.8575, F1: 0.5692
Epoch 11/50
Train - Loss: 0.4575, Acc: 0.8200, AUC: 0.9030, F1: 0.7729
Val   - Loss: 0.5084, Acc: 0.7650, AUC: 0.8572, F1: 0.6928
Epoch 12/50
Train - Loss: 0.3675, Acc: 0.8500, AUC: 0.9194, F1: 0.8089
Val   - Loss: 0.6562, Acc: 0.6400, AUC: 0.8624, F1: 0.6949
Final model saved to ./models/rsna/max/model_max.pth
Epoch 13/50
Train - Loss: 0.4387, Acc: 0.8450, AUC: 0.9125, F1: 0.8019
Val   - Loss: 0.4934, Acc: 0.7850, AUC: 0.8673, F1: 0.7362
Final model saved to ./models/rsna/max/model_max.pth
Epoch 14/50
Train - Loss: 0.3760, Acc: 0.8650, AUC: 0.9283, F1: 0.8297
Val   - Loss: 0.5824, Acc: 0.7650, AUC: 0.8613, F1: 0.7685
Epoch 15/50
Train - Loss: 0.3985, Acc: 0.8525, AUC: 0.9245, F1: 0.8156
Val   - Loss: 0.4834, Acc: 0.7750, AUC: 0.8716, F1: 0.7239
Final model saved to ./models/rsna/max/model_max.pth
Epoch 16/50
Train - Loss: 0.3462, Acc: 0.8638, AUC: 0.9310, F1: 0.8289
Val   - Loss: 0.4735, Acc: 0.7800, AUC: 0.8727, F1: 0.7027
Final model saved to ./models/rsna/max/model_max.pth
Epoch 17/50
Train - Loss: 0.3075, Acc: 0.8825, AUC: 0.9442, F1: 0.8517
Val   - Loss: 0.4707, Acc: 0.7700, AUC: 0.8738, F1: 0.6849
Final model saved to ./models/rsna/max/model_max.pth
Epoch 18/50
Train - Loss: 0.3921, Acc: 0.8825, AUC: 0.9396, F1: 0.8540
Val   - Loss: 0.5164, Acc: 0.7650, AUC: 0.8642, F1: 0.6846
Epoch 19/50
Train - Loss: 0.3580, Acc: 0.8750, AUC: 0.9422, F1: 0.8433
Val   - Loss: 0.4709, Acc: 0.8000, AUC: 0.8734, F1: 0.7590
Epoch 20/50
Train - Loss: 0.3400, Acc: 0.8862, AUC: 0.9469, F1: 0.8558
Val   - Loss: 0.4722, Acc: 0.7950, AUC: 0.8749, F1: 0.7602
Final model saved to ./models/rsna/max/model_max.pth
Epoch 21/50
Train - Loss: 0.2967, Acc: 0.9012, AUC: 0.9538, F1: 0.8771
Val   - Loss: 0.4891, Acc: 0.7750, AUC: 0.8705, F1: 0.7541
Epoch 22/50
Train - Loss: 0.3515, Acc: 0.8862, AUC: 0.9505, F1: 0.8567
Val   - Loss: 0.4716, Acc: 0.7700, AUC: 0.8756, F1: 0.6618
Final model saved to ./models/rsna/max/model_max.pth
Epoch 23/50
Train - Loss: 0.3140, Acc: 0.9000, AUC: 0.9533, F1: 0.8754
Val   - Loss: 0.4585, Acc: 0.7950, AUC: 0.8763, F1: 0.7515
Final model saved to ./models/rsna/max/model_max.pth
Epoch 24/50
Train - Loss: 0.3213, Acc: 0.9000, AUC: 0.9606, F1: 0.8742
Val   - Loss: 0.4506, Acc: 0.7950, AUC: 0.8787, F1: 0.7421
Final model saved to ./models/rsna/max/model_max.pth
Epoch 25/50
Train - Loss: 0.2441, Acc: 0.9075, AUC: 0.9694, F1: 0.8847
Val   - Loss: 0.4564, Acc: 0.7900, AUC: 0.8772, F1: 0.7470
Epoch 26/50
Train - Loss: 0.2720, Acc: 0.8950, AUC: 0.9673, F1: 0.8700
Val   - Loss: 0.4589, Acc: 0.7900, AUC: 0.8760, F1: 0.7083
Epoch 27/50
Train - Loss: 0.2549, Acc: 0.9025, AUC: 0.9668, F1: 0.8793
Val   - Loss: 0.5278, Acc: 0.7900, AUC: 0.8713, F1: 0.7375
Epoch 28/50
Train - Loss: 0.2558, Acc: 0.9275, AUC: 0.9720, F1: 0.9105
Val   - Loss: 0.4618, Acc: 0.7950, AUC: 0.8715, F1: 0.7248
Epoch 29/50
Train - Loss: 0.2384, Acc: 0.9250, AUC: 0.9753, F1: 0.9062
Val   - Loss: 0.4379, Acc: 0.8050, AUC: 0.8847, F1: 0.7578
Final model saved to ./models/rsna/max/model_max.pth
Epoch 30/50
Train - Loss: 0.2308, Acc: 0.9287, AUC: 0.9771, F1: 0.9119
Val   - Loss: 0.4585, Acc: 0.7950, AUC: 0.8809, F1: 0.7684
Epoch 31/50
Train - Loss: 0.2051, Acc: 0.9287, AUC: 0.9794, F1: 0.9124
Val   - Loss: 0.4754, Acc: 0.7800, AUC: 0.8690, F1: 0.7500
Epoch 32/50
Train - Loss: 0.1928, Acc: 0.9337, AUC: 0.9817, F1: 0.9183
Val   - Loss: 0.4432, Acc: 0.7850, AUC: 0.8786, F1: 0.7425
Epoch 33/50
Train - Loss: 0.1961, Acc: 0.9437, AUC: 0.9830, F1: 0.9307
Val   - Loss: 0.4985, Acc: 0.7850, AUC: 0.8721, F1: 0.7598
Epoch 34/50
Train - Loss: 0.2010, Acc: 0.9363, AUC: 0.9805, F1: 0.9217
Val   - Loss: 0.4518, Acc: 0.7900, AUC: 0.8795, F1: 0.7586
Early stopping triggered.
Model loaded successfully from ./models/rsna/max/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/max/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.5712
Accuracy: 0.8133, AUC: 0.9012
Precision: 0.8143, Recall: 0.7917, F1-Score: 0.8028
Confusion Matrix:
[[65 13]
 [15 57]]
