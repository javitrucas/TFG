rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
/home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Epoch 1/50
Train - Loss: 0.6910, Acc: 0.5800, AUC: 0.5089, F1: 0.1295
Val   - Loss: 0.6606, Acc: 0.5900, AUC: 0.6723, F1: 0.0000
Final model saved to ./models/rsna/model.pth
/home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
Epoch 2/50
Train - Loss: 0.6630, Acc: 0.5925, AUC: 0.6223, F1: 0.2010
Val   - Loss: 0.6505, Acc: 0.5900, AUC: 0.7124, F1: 0.0000
Final model saved to ./models/rsna/model.pth
Epoch 3/50
Train - Loss: 0.6386, Acc: 0.6425, AUC: 0.6893, F1: 0.3616
Val   - Loss: 0.6321, Acc: 0.6150, AUC: 0.7246, F1: 0.1149
Final model saved to ./models/rsna/model.pth
Epoch 4/50
Train - Loss: 0.6073, Acc: 0.6925, AUC: 0.7476, F1: 0.5020
Val   - Loss: 0.6096, Acc: 0.7200, AUC: 0.7366, F1: 0.5821
Final model saved to ./models/rsna/model.pth
Epoch 5/50
Train - Loss: 0.5875, Acc: 0.7125, AUC: 0.7669, F1: 0.5788
Val   - Loss: 0.5957, Acc: 0.7150, AUC: 0.7438, F1: 0.6069
Final model saved to ./models/rsna/model.pth
Epoch 6/50
Train - Loss: 0.5631, Acc: 0.7450, AUC: 0.7811, F1: 0.6483
Val   - Loss: 0.5786, Acc: 0.7200, AUC: 0.7586, F1: 0.6216
Final model saved to ./models/rsna/model.pth
Epoch 7/50
Train - Loss: 0.5452, Acc: 0.7388, AUC: 0.7965, F1: 0.6415
Val   - Loss: 0.5722, Acc: 0.7300, AUC: 0.7682, F1: 0.5909
Final model saved to ./models/rsna/model.pth
Epoch 8/50
Train - Loss: 0.5328, Acc: 0.7438, AUC: 0.8090, F1: 0.6520
Val   - Loss: 0.5554, Acc: 0.7200, AUC: 0.7795, F1: 0.6456
Final model saved to ./models/rsna/model.pth
Epoch 9/50
Train - Loss: 0.5411, Acc: 0.7288, AUC: 0.7930, F1: 0.6353
Val   - Loss: 0.5510, Acc: 0.7350, AUC: 0.7898, F1: 0.6187
Final model saved to ./models/rsna/model.pth
Epoch 10/50
Train - Loss: 0.5140, Acc: 0.7650, AUC: 0.8226, F1: 0.6846
Val   - Loss: 0.5403, Acc: 0.7300, AUC: 0.7940, F1: 0.6301
Final model saved to ./models/rsna/model.pth
Epoch 11/50
Train - Loss: 0.5145, Acc: 0.7550, AUC: 0.8161, F1: 0.6787
Val   - Loss: 0.5453, Acc: 0.7300, AUC: 0.7966, F1: 0.6029
Final model saved to ./models/rsna/model.pth
Epoch 12/50
Train - Loss: 0.5059, Acc: 0.7538, AUC: 0.8221, F1: 0.6744
Val   - Loss: 0.5343, Acc: 0.7400, AUC: 0.8010, F1: 0.6286
Final model saved to ./models/rsna/model.pth
Epoch 13/50
Train - Loss: 0.5028, Acc: 0.7488, AUC: 0.8282, F1: 0.6678
Val   - Loss: 0.5269, Acc: 0.7400, AUC: 0.8076, F1: 0.6338
Final model saved to ./models/rsna/model.pth
Epoch 14/50
Train - Loss: 0.5071, Acc: 0.7775, AUC: 0.8251, F1: 0.7072
Val   - Loss: 0.5218, Acc: 0.7350, AUC: 0.8125, F1: 0.6345
Final model saved to ./models/rsna/model.pth
Epoch 15/50
Train - Loss: 0.4825, Acc: 0.7675, AUC: 0.8465, F1: 0.6910
Val   - Loss: 0.5280, Acc: 0.7450, AUC: 0.8169, F1: 0.7052
Final model saved to ./models/rsna/model.pth
Epoch 16/50
Train - Loss: 0.4871, Acc: 0.7688, AUC: 0.8403, F1: 0.6962
Val   - Loss: 0.5089, Acc: 0.7350, AUC: 0.8227, F1: 0.6536
Final model saved to ./models/rsna/model.pth
Epoch 17/50
Train - Loss: 0.4861, Acc: 0.7725, AUC: 0.8396, F1: 0.7026
Val   - Loss: 0.5108, Acc: 0.7450, AUC: 0.8244, F1: 0.6752
Final model saved to ./models/rsna/model.pth
Epoch 18/50
Train - Loss: 0.4755, Acc: 0.7800, AUC: 0.8458, F1: 0.7152
Val   - Loss: 0.5052, Acc: 0.7450, AUC: 0.8277, F1: 0.6531
Final model saved to ./models/rsna/model.pth
Epoch 19/50
Train - Loss: 0.4694, Acc: 0.7900, AUC: 0.8538, F1: 0.7209
Val   - Loss: 0.5039, Acc: 0.7500, AUC: 0.8272, F1: 0.6835
Epoch 20/50
Train - Loss: 0.4771, Acc: 0.7775, AUC: 0.8479, F1: 0.7157
Val   - Loss: 0.5073, Acc: 0.7300, AUC: 0.8291, F1: 0.6197
Final model saved to ./models/rsna/model.pth
Epoch 21/50
Train - Loss: 0.4737, Acc: 0.7800, AUC: 0.8579, F1: 0.7124
Val   - Loss: 0.5060, Acc: 0.7250, AUC: 0.8309, F1: 0.6099
Final model saved to ./models/rsna/model.pth
Epoch 22/50
Train - Loss: 0.4687, Acc: 0.7725, AUC: 0.8543, F1: 0.7083
Val   - Loss: 0.5031, Acc: 0.7300, AUC: 0.8325, F1: 0.6143
Final model saved to ./models/rsna/model.pth
Epoch 23/50
Train - Loss: 0.4592, Acc: 0.7837, AUC: 0.8616, F1: 0.7196
Val   - Loss: 0.4985, Acc: 0.7550, AUC: 0.8346, F1: 0.7030
Final model saved to ./models/rsna/model.pth
Epoch 24/50
Train - Loss: 0.4630, Acc: 0.7775, AUC: 0.8591, F1: 0.7120
Val   - Loss: 0.4953, Acc: 0.7700, AUC: 0.8330, F1: 0.7089
Epoch 25/50
Train - Loss: 0.4482, Acc: 0.7950, AUC: 0.8699, F1: 0.7311
Val   - Loss: 0.4971, Acc: 0.7700, AUC: 0.8356, F1: 0.7229
Final model saved to ./models/rsna/model.pth
Epoch 26/50
Train - Loss: 0.4563, Acc: 0.7975, AUC: 0.8617, F1: 0.7387
Val   - Loss: 0.4966, Acc: 0.7650, AUC: 0.8371, F1: 0.7152
Final model saved to ./models/rsna/model.pth
Epoch 27/50
Train - Loss: 0.4458, Acc: 0.8000, AUC: 0.8723, F1: 0.7444
Val   - Loss: 0.5056, Acc: 0.7300, AUC: 0.8342, F1: 0.6143
Epoch 28/50
Train - Loss: 0.4536, Acc: 0.7987, AUC: 0.8635, F1: 0.7399
Val   - Loss: 0.4934, Acc: 0.7500, AUC: 0.8372, F1: 0.6667
Final model saved to ./models/rsna/model.pth
Epoch 29/50
Train - Loss: 0.4451, Acc: 0.7950, AUC: 0.8728, F1: 0.7346
Val   - Loss: 0.4921, Acc: 0.7600, AUC: 0.8396, F1: 0.6800
Final model saved to ./models/rsna/model.pth
Epoch 30/50
Train - Loss: 0.4478, Acc: 0.7887, AUC: 0.8682, F1: 0.7234
Val   - Loss: 0.4912, Acc: 0.7500, AUC: 0.8412, F1: 0.6622
Final model saved to ./models/rsna/model.pth
Epoch 31/50
Train - Loss: 0.4538, Acc: 0.7925, AUC: 0.8631, F1: 0.7323
Val   - Loss: 0.4874, Acc: 0.7600, AUC: 0.8421, F1: 0.6923
Final model saved to ./models/rsna/model.pth
Epoch 32/50
Train - Loss: 0.4452, Acc: 0.7987, AUC: 0.8680, F1: 0.7391
Val   - Loss: 0.4995, Acc: 0.7400, AUC: 0.8393, F1: 0.6389
Epoch 33/50
Train - Loss: 0.4326, Acc: 0.8037, AUC: 0.8807, F1: 0.7543
Val   - Loss: 0.5050, Acc: 0.7450, AUC: 0.8389, F1: 0.6434
Epoch 34/50
Train - Loss: 0.4210, Acc: 0.8163, AUC: 0.8865, F1: 0.7633
Val   - Loss: 0.4872, Acc: 0.7550, AUC: 0.8428, F1: 0.6879
Final model saved to ./models/rsna/model.pth
Epoch 35/50
Train - Loss: 0.4377, Acc: 0.8000, AUC: 0.8752, F1: 0.7468
Val   - Loss: 0.4817, Acc: 0.7500, AUC: 0.8488, F1: 0.6575
Final model saved to ./models/rsna/model.pth
Epoch 36/50
Train - Loss: 0.4391, Acc: 0.8025, AUC: 0.8767, F1: 0.7410
Val   - Loss: 0.4809, Acc: 0.7650, AUC: 0.8484, F1: 0.6928
Epoch 37/50
Train - Loss: 0.4413, Acc: 0.7900, AUC: 0.8723, F1: 0.7308
Val   - Loss: 0.4764, Acc: 0.7600, AUC: 0.8514, F1: 0.6883
Final model saved to ./models/rsna/model.pth
Epoch 38/50
Train - Loss: 0.4183, Acc: 0.8237, AUC: 0.8862, F1: 0.7737
Val   - Loss: 0.4817, Acc: 0.7650, AUC: 0.8477, F1: 0.6928
Epoch 39/50
Train - Loss: 0.4268, Acc: 0.8137, AUC: 0.8823, F1: 0.7639
Val   - Loss: 0.4944, Acc: 0.7450, AUC: 0.8506, F1: 0.6434
Epoch 40/50
Train - Loss: 0.4255, Acc: 0.8063, AUC: 0.8812, F1: 0.7488
Val   - Loss: 0.4864, Acc: 0.7600, AUC: 0.8508, F1: 0.6712
Epoch 41/50
Train - Loss: 0.4206, Acc: 0.8025, AUC: 0.8844, F1: 0.7468
Val   - Loss: 0.4738, Acc: 0.7600, AUC: 0.8546, F1: 0.7000
Final model saved to ./models/rsna/model.pth
Epoch 42/50
Train - Loss: 0.4134, Acc: 0.8175, AUC: 0.8910, F1: 0.7660
Val   - Loss: 0.4824, Acc: 0.7650, AUC: 0.8499, F1: 0.6928
Epoch 43/50
Train - Loss: 0.4234, Acc: 0.8137, AUC: 0.8814, F1: 0.7608
Val   - Loss: 0.4779, Acc: 0.7700, AUC: 0.8579, F1: 0.6892
Final model saved to ./models/rsna/model.pth
Epoch 44/50
Train - Loss: 0.4269, Acc: 0.8037, AUC: 0.8810, F1: 0.7447
Val   - Loss: 0.4748, Acc: 0.7550, AUC: 0.8599, F1: 0.6621
Final model saved to ./models/rsna/model.pth
Epoch 45/50
Train - Loss: 0.4200, Acc: 0.8037, AUC: 0.8857, F1: 0.7455
Val   - Loss: 0.4685, Acc: 0.7800, AUC: 0.8595, F1: 0.7250
Epoch 46/50
Train - Loss: 0.4246, Acc: 0.8175, AUC: 0.8831, F1: 0.7683
Val   - Loss: 0.5021, Acc: 0.7550, AUC: 0.8571, F1: 0.6316
Epoch 47/50
Train - Loss: 0.4121, Acc: 0.8150, AUC: 0.8905, F1: 0.7636
Val   - Loss: 0.4657, Acc: 0.7700, AUC: 0.8623, F1: 0.6974
Final model saved to ./models/rsna/model.pth
Epoch 48/50
Train - Loss: 0.4042, Acc: 0.8250, AUC: 0.8946, F1: 0.7742
Val   - Loss: 0.4700, Acc: 0.8050, AUC: 0.8614, F1: 0.7692
Epoch 49/50
Train - Loss: 0.4123, Acc: 0.8237, AUC: 0.8913, F1: 0.7758
Val   - Loss: 0.4647, Acc: 0.7850, AUC: 0.8594, F1: 0.7362
Epoch 50/50
Train - Loss: 0.4090, Acc: 0.8200, AUC: 0.8924, F1: 0.7662
Val   - Loss: 0.4669, Acc: 0.7950, AUC: 0.8608, F1: 0.7545
Model loaded successfully from ./models/rsna/model.pth

--- Evaluation Results ---
Optimal Threshold: 0.3681
Accuracy: 0.8000, AUC: 0.8851
Precision: 0.7763, Recall: 0.8194, F1-Score: 0.7973
Confusion Matrix:
[[61 17]
 [13 59]]
