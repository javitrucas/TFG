rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.7066, Acc: 0.6188, AUC: 0.6229, F1: 0.4732
Val   - Loss: 0.6873, Acc: 0.5700, AUC: 0.7193, F1: 0.6325
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 2/50
Train - Loss: 0.6065, Acc: 0.6837, AUC: 0.7207, F1: 0.5776
Val   - Loss: 0.5884, Acc: 0.6800, AUC: 0.7682, F1: 0.4483
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 3/50
Train - Loss: 0.6085, Acc: 0.6663, AUC: 0.7210, F1: 0.5714
Val   - Loss: 0.5963, Acc: 0.6500, AUC: 0.7952, F1: 0.3000
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 4/50
Train - Loss: 0.5717, Acc: 0.7150, AUC: 0.7650, F1: 0.6392
Val   - Loss: 0.6863, Acc: 0.6050, AUC: 0.8238, F1: 0.0706
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 5/50
Train - Loss: 0.5576, Acc: 0.7150, AUC: 0.7767, F1: 0.6250
Val   - Loss: 0.5216, Acc: 0.7300, AUC: 0.8401, F1: 0.5846
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 6/50
Train - Loss: 0.5496, Acc: 0.7238, AUC: 0.7847, F1: 0.6464
Val   - Loss: 0.5348, Acc: 0.7150, AUC: 0.8465, F1: 0.5210
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 7/50
Train - Loss: 0.5356, Acc: 0.7388, AUC: 0.7971, F1: 0.6656
Val   - Loss: 0.4758, Acc: 0.7750, AUC: 0.8547, F1: 0.7239
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 8/50
Train - Loss: 0.5162, Acc: 0.7512, AUC: 0.8128, F1: 0.6826
Val   - Loss: 0.7416, Acc: 0.6150, AUC: 0.8560, F1: 0.6778
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 9/50
Train - Loss: 0.4949, Acc: 0.7775, AUC: 0.8381, F1: 0.7210
Val   - Loss: 0.4833, Acc: 0.7400, AUC: 0.8618, F1: 0.6119
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 10/50
Train - Loss: 0.5177, Acc: 0.7712, AUC: 0.8194, F1: 0.7072
Val   - Loss: 0.4618, Acc: 0.7950, AUC: 0.8737, F1: 0.7545
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 11/50
Train - Loss: 0.5043, Acc: 0.7688, AUC: 0.8351, F1: 0.7040
Val   - Loss: 0.4983, Acc: 0.7700, AUC: 0.8759, F1: 0.7553
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 12/50
Train - Loss: 0.4760, Acc: 0.7863, AUC: 0.8496, F1: 0.7246
Val   - Loss: 0.6561, Acc: 0.6700, AUC: 0.8787, F1: 0.7105
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 13/50
Train - Loss: 0.4860, Acc: 0.7775, AUC: 0.8449, F1: 0.7184
Val   - Loss: 0.4939, Acc: 0.7300, AUC: 0.8881, F1: 0.5714
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 14/50
Train - Loss: 0.4713, Acc: 0.7925, AUC: 0.8514, F1: 0.7373
Val   - Loss: 0.7164, Acc: 0.6200, AUC: 0.8772, F1: 0.6807
Epoch 15/50
Train - Loss: 0.4895, Acc: 0.7725, AUC: 0.8383, F1: 0.7129
Val   - Loss: 0.5143, Acc: 0.7550, AUC: 0.8879, F1: 0.7562
Epoch 16/50
Train - Loss: 0.4885, Acc: 0.7775, AUC: 0.8375, F1: 0.7147
Val   - Loss: 0.5702, Acc: 0.7200, AUC: 0.8855, F1: 0.5254
Epoch 17/50
Train - Loss: 0.4626, Acc: 0.7937, AUC: 0.8601, F1: 0.7377
Val   - Loss: 0.4485, Acc: 0.7600, AUC: 0.8902, F1: 0.6522
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 18/50
Train - Loss: 0.4489, Acc: 0.8037, AUC: 0.8658, F1: 0.7496
Val   - Loss: 0.5921, Acc: 0.7250, AUC: 0.8872, F1: 0.7418
Epoch 19/50
Train - Loss: 0.4473, Acc: 0.7875, AUC: 0.8694, F1: 0.7344
Val   - Loss: 0.4447, Acc: 0.7650, AUC: 0.8934, F1: 0.6569
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 20/50
Train - Loss: 0.4521, Acc: 0.7963, AUC: 0.8651, F1: 0.7417
Val   - Loss: 0.5092, Acc: 0.7200, AUC: 0.8898, F1: 0.5484
Epoch 21/50
Train - Loss: 0.4404, Acc: 0.8037, AUC: 0.8715, F1: 0.7528
Val   - Loss: 0.5537, Acc: 0.7450, AUC: 0.8964, F1: 0.7560
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 22/50
Train - Loss: 0.4426, Acc: 0.7863, AUC: 0.8737, F1: 0.7290
Val   - Loss: 0.4246, Acc: 0.8300, AUC: 0.8977, F1: 0.8046
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 23/50
Train - Loss: 0.4471, Acc: 0.7812, AUC: 0.8695, F1: 0.7191
Val   - Loss: 0.4073, Acc: 0.8000, AUC: 0.9008, F1: 0.7297
Final model saved to ./models/rsna/mean/model_mean.pth
Epoch 24/50
Train - Loss: 0.4579, Acc: 0.7963, AUC: 0.8643, F1: 0.7425
Val   - Loss: 0.4941, Acc: 0.7750, AUC: 0.8986, F1: 0.7716
Epoch 25/50
Train - Loss: 0.4343, Acc: 0.7950, AUC: 0.8797, F1: 0.7429
Val   - Loss: 0.4147, Acc: 0.7950, AUC: 0.8974, F1: 0.7211
Epoch 26/50
Train - Loss: 0.4312, Acc: 0.8063, AUC: 0.8768, F1: 0.7536
Val   - Loss: 0.4438, Acc: 0.8250, AUC: 0.8994, F1: 0.8045
Epoch 27/50
Train - Loss: 0.4463, Acc: 0.7987, AUC: 0.8712, F1: 0.7480
Val   - Loss: 0.4083, Acc: 0.8250, AUC: 0.8987, F1: 0.7826
Epoch 28/50
Train - Loss: 0.4212, Acc: 0.8050, AUC: 0.8834, F1: 0.7578
Val   - Loss: 0.4362, Acc: 0.8300, AUC: 0.8957, F1: 0.8046
Early stopping triggered.
Model loaded successfully from ./models/rsna/mean/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/mean/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.6996
Accuracy: 0.8400, AUC: 0.9078
Precision: 0.9138, Recall: 0.7361, F1-Score: 0.8154
Confusion Matrix:
[[73  5]
 [19 53]]
