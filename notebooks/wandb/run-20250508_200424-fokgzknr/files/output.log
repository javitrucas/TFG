rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 1000 already processed bags
[RSNADataset] Number of bags found: 1000
rsna
[RSNADataset] Scanning files...
[RSNADataset] Found 150 already processed bags
[RSNADataset] Number of bags found: 150
Epoch 1/50
Train - Loss: 0.7508, Acc: 0.6238, AUC: 0.6368, F1: 0.4958
Val   - Loss: 0.6398, Acc: 0.6250, AUC: 0.7480, F1: 0.2105
Final model saved to ./models/rsna/model_attention.pth
Epoch 2/50
Train - Loss: 0.6184, Acc: 0.6775, AUC: 0.7231, F1: 0.5918
Val   - Loss: 0.5662, Acc: 0.7200, AUC: 0.7606, F1: 0.6456
Final model saved to ./models/rsna/model_attention.pth
Epoch 3/50
Train - Loss: 0.5855, Acc: 0.7400, AUC: 0.7636, F1: 0.6667
Val   - Loss: 0.5785, Acc: 0.6950, AUC: 0.7838, F1: 0.5547
Final model saved to ./models/rsna/model_attention.pth
Epoch 4/50
Train - Loss: 0.5800, Acc: 0.7087, AUC: 0.7687, F1: 0.6307
Val   - Loss: 0.5538, Acc: 0.7350, AUC: 0.8053, F1: 0.7039
Final model saved to ./models/rsna/model_attention.pth
Epoch 5/50
Train - Loss: 0.5495, Acc: 0.7212, AUC: 0.7935, F1: 0.6443
Val   - Loss: 0.6599, Acc: 0.6500, AUC: 0.7964, F1: 0.3137
Epoch 6/50
Train - Loss: 0.5625, Acc: 0.7400, AUC: 0.7927, F1: 0.6698
Val   - Loss: 0.5251, Acc: 0.7350, AUC: 0.8131, F1: 0.6748
Final model saved to ./models/rsna/model_attention.pth
Epoch 7/50
Train - Loss: 0.5423, Acc: 0.7375, AUC: 0.8024, F1: 0.6688
Val   - Loss: 0.8433, Acc: 0.6000, AUC: 0.8104, F1: 0.6522
Epoch 8/50
Train - Loss: 0.5268, Acc: 0.7400, AUC: 0.8153, F1: 0.6719
Val   - Loss: 0.5741, Acc: 0.7350, AUC: 0.8108, F1: 0.6187
Epoch 9/50
Train - Loss: 0.5342, Acc: 0.7325, AUC: 0.8077, F1: 0.6698
Val   - Loss: 0.5406, Acc: 0.7300, AUC: 0.8154, F1: 0.5909
Final model saved to ./models/rsna/model_attention.pth
Epoch 10/50
Train - Loss: 0.5072, Acc: 0.7512, AUC: 0.8280, F1: 0.6876
Val   - Loss: 0.6675, Acc: 0.7000, AUC: 0.8108, F1: 0.7059
Epoch 11/50
Train - Loss: 0.5235, Acc: 0.7575, AUC: 0.8225, F1: 0.6978
Val   - Loss: 0.7313, Acc: 0.6850, AUC: 0.8126, F1: 0.4220
Epoch 12/50
Train - Loss: 0.5152, Acc: 0.7512, AUC: 0.8288, F1: 0.6826
Val   - Loss: 0.4877, Acc: 0.7750, AUC: 0.8419, F1: 0.7305
Final model saved to ./models/rsna/model_attention.pth
Epoch 13/50
Train - Loss: 0.5400, Acc: 0.7612, AUC: 0.8173, F1: 0.7039
Val   - Loss: 0.4839, Acc: 0.7750, AUC: 0.8443, F1: 0.7305
Final model saved to ./models/rsna/model_attention.pth
Epoch 14/50
Train - Loss: 0.5083, Acc: 0.7775, AUC: 0.8363, F1: 0.7175
Val   - Loss: 0.5485, Acc: 0.7250, AUC: 0.8341, F1: 0.5802
Epoch 15/50
Train - Loss: 0.4810, Acc: 0.7725, AUC: 0.8528, F1: 0.7129
Val   - Loss: 0.6453, Acc: 0.6700, AUC: 0.8432, F1: 0.6972
Epoch 16/50
Train - Loss: 0.5003, Acc: 0.7550, AUC: 0.8412, F1: 0.6928
Val   - Loss: 0.6867, Acc: 0.6750, AUC: 0.8536, F1: 0.7032
Final model saved to ./models/rsna/model_attention.pth
Epoch 17/50
Train - Loss: 0.4941, Acc: 0.7725, AUC: 0.8462, F1: 0.7200
Val   - Loss: 0.5698, Acc: 0.7500, AUC: 0.8486, F1: 0.7449
Epoch 18/50
Train - Loss: 0.4731, Acc: 0.7900, AUC: 0.8603, F1: 0.7407
Val   - Loss: 0.6062, Acc: 0.7100, AUC: 0.8369, F1: 0.7100
Epoch 19/50
Train - Loss: 0.4742, Acc: 0.7887, AUC: 0.8579, F1: 0.7330
Val   - Loss: 0.4947, Acc: 0.8300, AUC: 0.8587, F1: 0.8068
Final model saved to ./models/rsna/model_attention.pth
Epoch 20/50
Train - Loss: 0.5024, Acc: 0.7725, AUC: 0.8439, F1: 0.7138
Val   - Loss: 0.5259, Acc: 0.7650, AUC: 0.8400, F1: 0.6619
Epoch 21/50
Train - Loss: 0.4662, Acc: 0.7950, AUC: 0.8621, F1: 0.7421
Val   - Loss: 0.4838, Acc: 0.8100, AUC: 0.8552, F1: 0.7654
Epoch 22/50
Train - Loss: 0.4511, Acc: 0.7950, AUC: 0.8739, F1: 0.7469
Val   - Loss: 0.8227, Acc: 0.6100, AUC: 0.8376, F1: 0.6638
Epoch 23/50
Train - Loss: 0.4523, Acc: 0.7900, AUC: 0.8702, F1: 0.7367
Val   - Loss: 0.5229, Acc: 0.8200, AUC: 0.8595, F1: 0.7857
Final model saved to ./models/rsna/model_attention.pth
Epoch 24/50
Train - Loss: 0.4835, Acc: 0.7750, AUC: 0.8591, F1: 0.7161
Val   - Loss: 0.5486, Acc: 0.7900, AUC: 0.8428, F1: 0.7123
Epoch 25/50
Train - Loss: 0.4746, Acc: 0.7762, AUC: 0.8557, F1: 0.7199
Val   - Loss: 0.5291, Acc: 0.7750, AUC: 0.8618, F1: 0.7619
Final model saved to ./models/rsna/model_attention.pth
Epoch 26/50
Train - Loss: 0.4769, Acc: 0.7837, AUC: 0.8574, F1: 0.7276
Val   - Loss: 0.4718, Acc: 0.8150, AUC: 0.8678, F1: 0.7758
Final model saved to ./models/rsna/model_attention.pth
Epoch 27/50
Train - Loss: 0.4783, Acc: 0.7963, AUC: 0.8695, F1: 0.7504
Val   - Loss: 0.6081, Acc: 0.7250, AUC: 0.8480, F1: 0.7317
Epoch 28/50
Train - Loss: 0.4736, Acc: 0.7987, AUC: 0.8626, F1: 0.7504
Val   - Loss: 0.5103, Acc: 0.8100, AUC: 0.8617, F1: 0.7625
Epoch 29/50
Train - Loss: 0.4624, Acc: 0.7887, AUC: 0.8749, F1: 0.7363
Val   - Loss: 0.5791, Acc: 0.7650, AUC: 0.8599, F1: 0.7539
Epoch 30/50
Train - Loss: 0.4213, Acc: 0.8250, AUC: 0.8915, F1: 0.7833
Val   - Loss: 0.5254, Acc: 0.7900, AUC: 0.8585, F1: 0.7237
Epoch 31/50
Train - Loss: 0.4672, Acc: 0.7875, AUC: 0.8681, F1: 0.7344
Val   - Loss: 0.5146, Acc: 0.8150, AUC: 0.8537, F1: 0.7784
Early stopping triggered.
Model loaded successfully from ./models/rsna/model.pth
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:64: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.4754
Accuracy: 0.8200, AUC: 0.8811
Precision: 0.8169, Recall: 0.8056, F1-Score: 0.8112
Confusion Matrix:
[[65 13]
 [14 58]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
Requirement already satisfied: wandb in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (0.19.7)
Requirement already satisfied: click!=8.0.0,>=7.1 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (8.1.8)
Requirement already satisfied: docker-pycreds>=0.4.0 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (0.4.0)
Requirement already satisfied: gitpython!=3.1.29,>=1.0.0 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (3.1.44)
Requirement already satisfied: platformdirs in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (4.3.6)
Requirement already satisfied: protobuf!=4.21.0,!=5.28.0,<6,>=3.19.0 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (5.29.3)
Requirement already satisfied: psutil>=5.0.0 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (7.0.0)
Requirement already satisfied: pydantic<3,>=2.6 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (2.10.6)
Requirement already satisfied: pyyaml in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (6.0.2)
Requirement already satisfied: requests<3,>=2.0.0 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (2.32.3)
Requirement already satisfied: sentry-sdk>=2.0.0 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (2.22.0)
Requirement already satisfied: setproctitle in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (1.3.5)
Requirement already satisfied: setuptools in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (75.8.0)
Requirement already satisfied: typing-extensions<5,>=4.4 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from wandb) (4.12.2)
Requirement already satisfied: six>=1.4.0 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from docker-pycreds>=0.4.0->wandb) (1.16.0)
Requirement already satisfied: gitdb<5,>=4.0.1 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from gitpython!=3.1.29,>=1.0.0->wandb) (4.0.12)
Requirement already satisfied: annotated-types>=0.6.0 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from pydantic<3,>=2.6->wandb) (0.7.0)
Requirement already satisfied: pydantic-core==2.27.2 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from pydantic<3,>=2.6->wandb) (2.27.2)
Requirement already satisfied: charset-normalizer<4,>=2 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from requests<3,>=2.0.0->wandb) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from requests<3,>=2.0.0->wandb) (3.7)
Requirement already satisfied: urllib3<3,>=1.21.1 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from requests<3,>=2.0.0->wandb) (2.3.0)
Requirement already satisfied: certifi>=2017.4.17 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from requests<3,>=2.0.0->wandb) (2025.1.31)
Requirement already satisfied: smmap<6,>=3.0.1 in /home/javitrucas/miniconda3/envs/tfg/lib/python3.11/site-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.29,>=1.0.0->wandb) (5.0.2)
Note: you may need to restart the kernel to use updated packages.
