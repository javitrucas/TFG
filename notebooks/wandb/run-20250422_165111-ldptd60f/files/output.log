panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|██████████| 8822/8822 [01:48<00:00, 81.54it/s]
[WSIDataset] Building data dict: 100%|██████████| 1794/1794 [00:17<00:00, 101.10it/s]
[WSIDataset] Skipped 5 bags
[WSIDataset] Found 8817 already processed bags
panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|█████████▉| 1788/1794 [00:17<00:00, 96.34it/s] 
[WSIDataset] Skipped 0 bags
[WSIDataset] Found 1794 already processed bags
Epoch 1/15
Train - Loss: 0.2541, Acc: 0.9117, AUC: 0.9633, F1: 0.9395
Val   - Loss: 0.1698, Acc: 0.9535, AUC: 0.9876, F1: 0.9674
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 2/15
Train - Loss: 0.2385, Acc: 0.9258, AUC: 0.9733, F1: 0.9491
Val   - Loss: 0.1850, Acc: 0.9473, AUC: 0.9895, F1: 0.9627
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 3/15
Train - Loss: 0.2379, Acc: 0.9294, AUC: 0.9755, F1: 0.9515
Val   - Loss: 0.1666, Acc: 0.9490, AUC: 0.9876, F1: 0.9649
Epoch 4/15
Train - Loss: 0.2420, Acc: 0.9307, AUC: 0.9752, F1: 0.9524
Val   - Loss: 0.1723, Acc: 0.9473, AUC: 0.9870, F1: 0.9631
Epoch 5/15
Train - Loss: 0.2690, Acc: 0.9319, AUC: 0.9752, F1: 0.9533
Val   - Loss: 0.1877, Acc: 0.9456, AUC: 0.9890, F1: 0.9615
Epoch 6/15
Train - Loss: 0.2646, Acc: 0.9321, AUC: 0.9764, F1: 0.9534
Val   - Loss: 0.2938, Acc: 0.9512, AUC: 0.9872, F1: 0.9657
Epoch 7/15
Train - Loss: 0.3013, Acc: 0.9344, AUC: 0.9757, F1: 0.9549
Val   - Loss: 0.4326, Acc: 0.9286, AUC: 0.9906, F1: 0.9485
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 8/15
Train - Loss: 0.3229, Acc: 0.9336, AUC: 0.9736, F1: 0.9544
Val   - Loss: 0.4789, Acc: 0.9325, AUC: 0.9750, F1: 0.9544
Epoch 9/15
Train - Loss: 0.3102, Acc: 0.9338, AUC: 0.9766, F1: 0.9545
Val   - Loss: 0.2476, Acc: 0.9467, AUC: 0.9892, F1: 0.9638
Epoch 10/15
Train - Loss: 0.3126, Acc: 0.9366, AUC: 0.9752, F1: 0.9565
Val   - Loss: 0.1705, Acc: 0.9603, AUC: 0.9912, F1: 0.9724
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 11/15
Train - Loss: 0.3315, Acc: 0.9375, AUC: 0.9745, F1: 0.9571
Val   - Loss: 0.3058, Acc: 0.9450, AUC: 0.9858, F1: 0.9621
Epoch 12/15
Train - Loss: 0.3129, Acc: 0.9383, AUC: 0.9759, F1: 0.9577
Val   - Loss: 0.2722, Acc: 0.9490, AUC: 0.9856, F1: 0.9647
Epoch 13/15
Train - Loss: 0.2780, Acc: 0.9409, AUC: 0.9795, F1: 0.9594
Val   - Loss: 0.2213, Acc: 0.9444, AUC: 0.9905, F1: 0.9627
Epoch 14/15
Train - Loss: 0.3328, Acc: 0.9370, AUC: 0.9753, F1: 0.9568
Val   - Loss: 0.2411, Acc: 0.9552, AUC: 0.9886, F1: 0.9687
Epoch 15/15
Train - Loss: 0.3420, Acc: 0.9361, AUC: 0.9751, F1: 0.9561
Val   - Loss: 0.3442, Acc: 0.9399, AUC: 0.9854, F1: 0.9593
Early stopping triggered.
Model loaded successfully from ./models/panda/attention/model.pth
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.9998
Accuracy: 0.9365, AUC: 0.9761
Precision: 0.9821, Recall: 0.9291, F1-Score: 0.9548
Confusion Matrix:
[[ 475   22]
 [  92 1205]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
