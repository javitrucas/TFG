panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict: 100%|██████████| 8822/8822 [01:43<00:00, 84.93it/s]
[WSIDataset] Building data dict: 100%|██████████| 1794/1794 [00:18<00:00, 99.06it/s]]
[WSIDataset] Skipped 5 bags
[WSIDataset] Found 8817 already processed bags
panda
[WSIDataset] Scanning files...
[WSIDataset] Building data dict:  99%|█████████▉| 1785/1794 [00:18<00:00, 97.57it/s] 
[WSIDataset] Skipped 0 bags
[WSIDataset] Found 1794 already processed bags
Epoch 1/15
Train - Loss: 0.1629, Acc: 0.9342, AUC: 0.9792, F1: 0.9548
Val   - Loss: 0.1536, Acc: 0.9393, AUC: 0.9803, F1: 0.9580
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 2/15
Train - Loss: 0.1242, Acc: 0.9495, AUC: 0.9875, F1: 0.9652
Val   - Loss: 0.1394, Acc: 0.9439, AUC: 0.9840, F1: 0.9613
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 3/15
Train - Loss: 0.1123, Acc: 0.9531, AUC: 0.9895, F1: 0.9676
Val   - Loss: 0.1435, Acc: 0.9439, AUC: 0.9844, F1: 0.9612
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 4/15
Train - Loss: 0.1054, Acc: 0.9603, AUC: 0.9908, F1: 0.9726
Val   - Loss: 0.1449, Acc: 0.9405, AUC: 0.9846, F1: 0.9583
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 5/15
Train - Loss: 0.1007, Acc: 0.9616, AUC: 0.9916, F1: 0.9735
Val   - Loss: 0.1485, Acc: 0.9331, AUC: 0.9849, F1: 0.9545
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 6/15
Train - Loss: 0.0939, Acc: 0.9647, AUC: 0.9927, F1: 0.9757
Val   - Loss: 0.1479, Acc: 0.9473, AUC: 0.9844, F1: 0.9634
Epoch 7/15
Train - Loss: 0.0909, Acc: 0.9663, AUC: 0.9930, F1: 0.9767
Val   - Loss: 0.1512, Acc: 0.9405, AUC: 0.9840, F1: 0.9583
Epoch 8/15
Train - Loss: 0.0835, Acc: 0.9681, AUC: 0.9939, F1: 0.9781
Val   - Loss: 0.1532, Acc: 0.9416, AUC: 0.9849, F1: 0.9597
Epoch 9/15
Train - Loss: 0.0822, Acc: 0.9698, AUC: 0.9942, F1: 0.9792
Val   - Loss: 0.1417, Acc: 0.9461, AUC: 0.9853, F1: 0.9627
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 10/15
Train - Loss: 0.0781, Acc: 0.9705, AUC: 0.9948, F1: 0.9797
Val   - Loss: 0.1478, Acc: 0.9371, AUC: 0.9846, F1: 0.9571
Epoch 11/15
Train - Loss: 0.0709, Acc: 0.9719, AUC: 0.9956, F1: 0.9807
Val   - Loss: 0.1466, Acc: 0.9450, AUC: 0.9860, F1: 0.9619
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 12/15
Train - Loss: 0.0725, Acc: 0.9733, AUC: 0.9955, F1: 0.9816
Val   - Loss: 0.1473, Acc: 0.9473, AUC: 0.9861, F1: 0.9631
Final model saved to ./models/panda/attention/model_attention.pth
Epoch 13/15
Train - Loss: 0.0709, Acc: 0.9743, AUC: 0.9956, F1: 0.9823
Val   - Loss: 0.1452, Acc: 0.9439, AUC: 0.9858, F1: 0.9612
Epoch 14/15
Train - Loss: 0.0634, Acc: 0.9762, AUC: 0.9965, F1: 0.9836
Val   - Loss: 0.1742, Acc: 0.9467, AUC: 0.9852, F1: 0.9627
Epoch 15/15
Train - Loss: 0.0628, Acc: 0.9782, AUC: 0.9965, F1: 0.9850
Val   - Loss: 0.1529, Acc: 0.9456, AUC: 0.9865, F1: 0.9622
Final model saved to ./models/panda/attention/model_attention.pth
Model loaded successfully from ./models/panda/attention/model.pth
  ax.set_xticklabels([''] + ["Negative", "Positive"])
/home/javitrucas/TFG/scripts/medical_scripts/medical_evaluation.py:65: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([''] + ["Negative", "Positive"])
Confusion matrix saved at output/attention/confusion_matrix.png

--- Evaluation Results ---
Optimal Threshold: 0.8682
Accuracy: 0.9532, AUC: 0.9890
Precision: 0.9856, Recall: 0.9491, F1-Score: 0.9670
Confusion Matrix:
[[ 479   18]
 [  66 1231]]
Attention heatmap 0 saved at output/attention/attention_heatmap_0.png
Attention heatmap 1 saved at output/attention/attention_heatmap_1.png
Attention heatmap 2 saved at output/attention/attention_heatmap_2.png
Attention heatmap 3 saved at output/attention/attention_heatmap_3.png
Attention heatmap 4 saved at output/attention/attention_heatmap_4.png
